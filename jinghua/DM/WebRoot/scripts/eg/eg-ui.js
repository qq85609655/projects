(function(){EG.define("EG.UI",{statics:{skin:"default",getSkinPath:function(a){return EG.basePath+"/skins/"+EG.UI.skin+"/"+a},sheet:null,setSkin:function(a){if(!EG.UI.sheet){EG.UI.sheet=EG.Style.createSheet("")}EG.UI.sheet.href=EG.basePath+"/skins/"+a+"/ui.css";EG.UI.skin=a},GITEMIDX:0,GITEMS:{}}});EG.RESIZING=false;EG.onload(function(){})})();(function(){EG.define("EG.ui.Item",{config:{renderTo:null,id:null,width:null,height:null,style:null,cls:null,region:null,vAlign:null,hidden:false},constructor:function(b){this.initItem(b);this.build();this.getElement().item=this;if(this.id){this.getElement().id=this.id}a.setStyle(this);this.afterBuild();a.doRenderTo(this);if(this.hidden){EG.hide(this.getElement())}},afterBuild:function(){},getStyleEle:function(){return this.getElement()},getElement:function(){return this.element},render:function(){},initItem:function(b){this.initConfig(b);this.oWidth=this.width;this.oHeight=this.height;this.pItem=null},getOWidth:function(){return this.oWidth},getOHeight:function(){return this.oHeight},getSize:function(){return EG.getSize(this.getElement())},build:function(){this.element=EG.CE({tn:"div"})},destroy:function(){},setHidden:function(b){this.hidden=b;if(this.hidden){EG.hide(this.getElement())}else{EG.show(this.getElement())}},isItem:true,statics:{itemClasses:{},regist:function(b,c){EG.ui.Item.itemClasses[b]=c},create:function(d,b){if(!d){d="panel"}var c=a.itemClasses[d]||EG.ui[EG.Word.first2Uppercase(d)];if(!c){throw new Error("EG.ui.Item#create:不支持类型:"+d)}return new c(b)},setWidth:function(b,c){EG.ui.Item.setSize(b,c,"width")},setHeight:function(c,b){EG.ui.Item.setSize(c,b,"height")},setStyle:function(b){if(b.cls){EG.setCls(b.getStyleEle(),b.cls)}if(b.style){EG.css(b.getStyleEle(),b.style)}},initItem:function(b){if(b.renderTo){if(b.element.parentNode==null){if(EG.ui.Item.isItem(b.renderTo)){b.renderTo.addItem(b)}else{if(EG.DOM.isElement(b.renderTo)){b.renderTo.appendChild(b.element)}}}b.render()}},setSize:function(b,d,c){if(d!=null){if(typeof(d)=="number"){EG.css(b,c+":"+d+"px")}else{EG.css(b,c+":"+d)}}else{EG.css(b,c+":100%")}},fit:function(e){if(a.isItem(e)){e={item:e}}var k=e.item,c=e.element;if(!c){if(k){c=k.element}else{throw new Error("fit:没有element")}}var b=e.sSize||EG.getSize(c);var g=e.dSize;if(!g){if(k&&(k.width!=null||k.height!=null)){g={width:k.width,height:k.height}}else{g={width:"100%",height:"100%"}}}var f=e.pSize||EG.getSize(c.parentNode);if(f.width==null&&f.innerWidth!=null){f.width=f.innerWidth}if(f.height==null&&f.innerHeight!=null){f.height=f.innerHeight}var i=e.type||"all",j,d;if(g.width!=null&&g.width!="auto"&&(i=="all"||i=="width")){j=EG.Style.size2Num(g.width,f.width)-(b.outerWidth-b.innerWidth-b.vScrollWidth);if(j<0){j=0}EG.css(c,{width:j+"px"})}if(g.height!=null&&g.height!="auto"&&(i=="all"||i=="height")){d=EG.Style.size2Num(g.height,f.height)-(b.outerHeight-b.innerHeight-b.hScrollWidth);if(d<0){d=0}EG.css(c,{height:d+"px"})}return{width:j,height:d,pSize:f}},pack:function(e){var i=e.item;var g=e.pEle||(i?i.getElement():null);var c=e.cEle;var b=e.width;var h=e.height;var f=e.pSize||EG.getSize(g);if(c&&(b==null||h==null)){var j=EG.getSize(c);if(b==null){b=j.outerWidth}if(h==null){h=j.outerHeight}}var d={};if(b!=null){b=(f.paddingLeft+b+f.paddingRight);EG.css(g,"width:"+b+"px");d.width=b}if(h!=null){h=(f.paddingTop+h+f.paddingBottom);EG.css(g,"height:"+h+"px");d.height=h}return d},isItem:function(b){return b&&typeof(b.getElement)=="function"},doRenderTo:function(b){if(b.renderTo){EG.$(b.renderTo).appendChild(b.getElement());b.render()}},doLayout:function(e,c){if(!c){c=e.items}if(!c){return}if(e.layoutManager){e.layoutManager.doLayout()}for(var d=0,b=e.items.length;d<b;d++){if(c[d].doLayout){c[d].doLayout()}}},afterExtend:function(b){(function(){var c=b.prototype.render;if(c){b.prototype.render=function(){if(!EG.DOM.isActive(this.getElement())){return}if(EG.Style.isHide(this.getElement().parentNode,true)){return}c.apply(this,arguments)}}})()},fixBody:function(c){var b=c.parentNode;if(b==EG.getBody()){EG.css(EG.getBody(),"margin:0px;padding:0px;width:100%;height:100%");EG.css(c,"position:absolute;left:0px;top:0px;")}},$:function(b){return EG.$(b).item}}});var a=EG.ui.Item;EG.Item=a;EG.fit=a.fit;EG.isItem=a.isItem})();(function(){EG.define("EG.ui.Container",{extend:"EG.ui.Item",config:{layout:"default",itemsConfig:[],cnConfig:[],innerHTML:null},constructor:function(a){this.items=[];this.callSuper([a])},afterBuild:function(){this.setLayout(this.layout,false);if(this.itemsConfig.length>0){this.addItem(this.itemsConfig,true)}else{if(this.cnConfig.length>0){this.addChildren(this.cnConfig,null,false)}else{if(this.innerHTML){this.getItemContainer().innerHTML=this.innerHTML}}}},getItemContainer:function(){return this.element},addItem:function(g,e,a){var d=(!EG.isArray(g))?[g]:g;var c=[];for(var f=0,b=d.length;f<b;f++){g=d[f];if(EG.isLit(g)){g=EG.Item.create(g.xtype,g)}g.pItem=this;if(a>=0){EG.Array.insert(this.items,a,g)}else{this.items.push(g)}if(this.layoutManager.addOnLayout){continue}EG.DOM.addChildren(this.getItemContainer(),g.getElement(),a);c.push(g)}if(!e){if(!this.whenPItemIsAuto()){this.doLayout()}}return c.length>1?c:c[0]},removeItem:function(b,a){if(a==null){a=true}this.getItemContainer().removeChild(b.getElement());EG.Array.remove(this.items,b);b.pItem=null;if(a){if(!this.whenPItemIsAuto()){this.doLayout()}}},addChildren:function(c,a,b){if(b==null){b=true}EG.DOM.addChildren(this.getItemContainer(),c,a);if(b){this.doLayout()}},render:function(){EG.ui.Item.fixBody(this.element);EG.fit(this);if(this.items.length>0||this.layoutManager.force){this.doLayout()}},getItem:function(a){if(typeof(a)=="number"){return this.items[a]}else{if(this.layoutManager){return this.layoutManager.getItem(a)}else{throw new Error("无法获取Item,参数不对或布局器不存在")}}},setLayout:function(a,b){if(b==null){b=true}this.layout=a;this.layoutManager=EG.ui.Layout.create(this.layout,this);if(b){this.layoutManager.doLayout()}},doLayout:function(){var a=EG.Style.current(this.element).overflow;EG.css(this.element,"overflow:hidden");this.layoutManager.doLayout();EG.css(this.element,"overflow:"+a)},whenPItemIsAuto:function(){if(this.pItem){var a=this.pItem.isAutoWidth();var b=this.pItem.isAutoWidth();if(!a&&!b&&(this.isAutoWidth()||this.isAutoHeight())){this.pItem.doLayout();return true}else{if(a||b){var c=this.pItem;while(c.pItem){if(!c.pItem.isAutoWidth()&&!c.pItem.isAutoHeight()){break}else{c=c.pItem}}c.doLayout();return true}}}return false},getItemLeft:function(){return this.getItem({region:"left"})},getItemCenter:function(){return this.getItem({region:"center"})},getItemRight:function(){return this.getItem({region:"right"})},getItemTop:function(){return this.getItem({region:"top"})},getItemBottom:function(){return this.getItem({region:"bottom"})},isAutoWidth:function(){return this.getOWidth()=="auto"},isAutoHeight:function(){return this.getOHeight()=="auto"},setInnerWidth:function(b,a){a=EG.n2d(a,true);EG.ui.Container.autoSize(this.getItemContainer(),b,"width");if(a){this.width=this.getSize().outerWidth}},setInnerHeight:function(a,b){b=EG.n2d(b,true);EG.ui.Container.autoSize(this.getItemContainer(),a,"height");if(b){this.height=this.getSize().outerHeight}},getInnerHeight:function(){return EG.getSize(this.getItemContainer()).innerHeight},getInnerWidth:function(){return EG.getSize(this.getItemContainer()).innerWidth},destroy:function(){for(var a=0;a<this.items.length;a++){this.items[a].destroy()}this.items=null},clear:function(){for(var a=0;a<this.items.length;a++){if(this.items[a].isContainer){this.items[a].clear()}}EG.DOM.removeChilds(this.getItemContainer());EG.Array.clear(this.items)},isContainer:true,statics:{autoSize:function(c,a,b){var d=c.isItem?c.getElement():c;EG.css(d,(b=="width"?"width":"height")+":"+a+"px")},afterExtend:function(a){(function(){var b=a.prototype.doLayout;if(b){a.prototype.doLayout=function(){if(!EG.DOM.isActive(this.getElement())){return}b.apply(this,arguments)}}})()}}})})();(function(){EG.ui.Component=function(){};EG.ui.Component.addChildren=function(d,e){var c=(!EG.isArray(e))?[e]:e;for(var b=0,a=c.length;b<a;b++){e=c[b];if(EG.isLit(e)){e=EG.CE(e)}d.getElement().appendChild(e)}}})();(function(){EG.define("EG.ui.Drag",{config:{target:null,handle:null,parent:null,moveTarget:false,onDrag:null,afterDragup:null,sycHandleSize:false},constructor:function(a){EG.ui.Drag.load();this.initConfig(a);this.handles=[];if(this.handle||this.target){this.bindHandle(this.handle||this.target)}this.bindParent(this.parent||EG.getBody())},bindHandle:function(e){var d=this.getClass();this.handles.push(e);var e=(!EG.isArray(e))?[e]:e;for(var b=0,a=e.length;b<a;b++){var c=e[b];if(c.getElement){c=c.getElement}EG.CE({ele:c,style:"cursor:move",onmousedown:d._events.handle.onmousedown,me:this})}},bindParent:function(a){this.parent=a},statics:{load:function(){var a=EG.ui.Drag;a.selectable=true;if(!a.loaded){EG.CE({ele:EG.getBody(),_drager:true,onselectstart:function(){return a.selectable},onmouseup:a._events.parent.onmouseup,onmousemove:a._events.parent.onmousemove});a._drager=EG.CE({pn:EG.getBody(),tn:"div",style:"position:absolute;z-index:3;border:1px dashed;background-color:gray;opacity:0.5;-moz-opacity:0.5;filter:alpha(opacity=50);"});a.loaded=true}},_events:{handle:{onmousedown:function(c){var b=EG.ui.Drag;b.curDrag=this.me;var d=this;while(true){if(EG.Array.has(this.me.handles,d)){break}else{d=this.parentNode;if(d==null){break}}}if(d==null){throw new Error("发生预料外的错误->未找到拖拽节点")}b.curHandle=d;var a=b.curDrag.sycHandleSize?d:this.me.target;b.refPos=EG.Tools.getMousePos(c,a);b.showDrager(c);return true}},parent:{onmousemove:function(d){var a=EG.ui.Drag;if(!a.curDrag){return}if(!EG.Tools.isPressLeft(d)){a.dragup()}var f=EG.Tools.getMousePos(d);var c=f.y-a.refPos.y;var b=f.x-a.refPos.x;EG.css(a._drager,"top:"+c+"px;left:"+b+"px;");if(a.curDrag.onDrag){a.curDrag.onDrag.apply(a.curDrag,[d])}},onmouseup:function(){var a=EG.ui.Drag;a.dragup()}}},dragup:function(){var c=EG.ui.Drag;if(!c.curDrag){return}if(EG.Style.isHide(c._drager)){return}var b=EG.Style.current(c._drager);var e=b.top=="auto"?"0":b.top;var d=b.left=="auto"?"0":b.left;if(c.curDrag.parent!=EG.getBody()){var a=EG.Tools.getElementPos(c.curDrag.parent);e=(parseInt(EG.String.removeEnd(e,"px"))-a.y)+"px";d=(parseInt(EG.String.removeEnd(d,"px"))-a.x)+"px"}if(c.curDrag.moveTarget){EG.css(c.curDrag.target,"position:absolute;top:"+e+";left:"+d+";")}c.hideDrager();if(c.curDrag.afterDragup){c.curDrag.afterDragup.apply(this)}c.curDrag=false;EG.ui.Drag.complete=true},bindDrag:function(a){new EG.ui.Drag(a)},showDrager:function(f){f=EG.Event.getEvent(f);var b=EG.ui.Drag;if(!b._drager){}b.selectable=false;var h=EG.Tools.getMousePos(f);var d=h.y-b.refPos.y;var c=h.x-b.refPos.x;EG.css(b._drager,"top:"+d+"px;left:"+c+"px;");EG.show(b._drager);var g=b.curDrag.sycHandleSize?b.curHandle:b.curDrag.target;var a=EG.getSize(g);EG.Item.fit({element:b._drager,dSize:{width:a.outerWidth,height:a.outerHeight}})},hideDrager:function(){var a=EG.ui.Drag;a.selectable=true;EG.hide(a._drager)}}})})();(function(){EG.define("EG.ui.Pop",{extend:"EG.ui.Container",config:{cls:"eg_pop",lock:false,posFix:true,innerHTML:null,target:null,parent:null,afterOpen:null},constructor:function(a){var b=this;this.callSuper([a]);EG.hide(this.element)},build:function(){this.element=EG.CE({tn:"div",cls:this.cls+"-outer",cn:[this.dLocker=EG.CE({tn:"div",cls:this.cls+"-locker"}),this.dPop=EG.CE({tn:"div",cls:this.cls})]})},getStyleEle:function(){return this.dPop},getItemContainer:function(){return this.dPop},open:function(){EG.show(this.element);this.render();if(this.afterOpen){this.afterOpen.apply(this)}},close:function(){EG.hide(this.element)},render:function(){var b=this.parent||this.getElement().parentNode;var a=EG.getSize(b);EG.fit({element:this.element,dSize:{width:a.innerWidth,height:a.innerHeight}});EG.fit({element:this.dPop,dSize:{width:this.width,height:this.height}});if(this.items.length>0){this.doLayout()}if(this.lock){this.fullLock()}if(this.posFix){this.doPosFix()}},fullLock:function(){EG.fit({element:this.dLocker,dSize:{width:"100%",height:"100%"},pSize:EG.getSize(this.getElement())})},doPosFix:function(){EG.Style.center(this.dPop,this.getElement());EG.Style.middle(this.dPop,this.getElement())},moveTo:function(a){EG.Style.moveTo(this.dPop,a)},isOpen:function(){return !EG.Style.isHide(this.element)}})})();(function(){EG.define("EG.ui.Dialog",{extend:"EG.ui.Pop",config:{cls:"eg_dialog",title:null,btnsConfig:null,zIndex:null,bodyStyle:null,headStyle:null,footStyle:null,closeable:true,fullable:false,dragable:false},constructor:function(a){this.callSuper([a]);if(this.title){this.setTitle(this.title)}if(this.btnsConfig){this.setButtons(this.btnsConfig)}this.setFullable(this.fullable);this.setCloseable(this.closeable);this.setDragable(this.dragable)},build:function(){var a=EG.ui.Dialog;this.callSuper("build");this.dHead=EG.CE({pn:this.dPop,tn:"div",cls:this.cls+"-head",cn:[this.dTitle=EG.CE({tn:"div",cls:this.cls+"-title"}),EG.CE({tn:"div",cls:this.cls+"-trBtns",cn:[this.dFuller=EG.CE({tn:"a",cls:this.cls+"-fuller",me:this,onmouseup:a._events.dFuller.onmouseup,onmousedown:a._events.dFuller.onmousedown}),this.dCloser=EG.CE({tn:"a",cls:this.cls+"-closer",me:this,onmouseup:a._events.dCloser.onmouseup,onmousedown:a._events.dCloser.onmousedown})]})]});this.dBody=EG.CE({pn:this.dPop,tn:"div",cls:this.cls+"-body"});this.dFoot=EG.CE({pn:this.dPop,tn:"div",cls:this.cls+"-foot"});if(this.bodyStyle){EG.css(this.dBody,this.bodyStyle)}if(this.headStyle){EG.css(this.dHead,this.headStyle)}if(this.footStyle){EG.css(this.dFoot,this.footStyle)}if(this.zIndex!=null){EG.css(this.element,"z-index:"+this.zIndex)}},getItemContainer:function(){return this.dBody},setFullable:function(a){if(a){EG.show(this.dFuller)}else{EG.hide(this.dFuller)}},setDragable:function(a){this.dragable=a;if(!this.drag){this.drag=new EG.ui.Drag({target:this.dPop,parent:this.dLocker,handle:this.dHead,moveTarget:true})}},setCloseable:function(a){if(a){EG.show(this.dCloser)}else{EG.hide(this.dCloser)}},setButtons:function(d){EG.DOM.removeChilds(this.dFoot);if(d==null){return}for(var c=0,a=d.length;c<a;c++){var b=EG.isLit(d[c])?new EG.ui.Button(d[c]):d[c];this.dFoot.appendChild(b.getElement())}},setTitle:function(a){EG.setValue(this.dTitle,a)},setInnerWidth:function(a){EG.Item.pack({pEle:this.dBody,width:a});EG.Item.pack({pEle:this.dPop,width:EG.getSize(this.dBody).outerWidth})},setInnerHeight:function(a){EG.Item.pack({pEle:this.dBody,height:a});EG.Item.pack({pEle:this.dPop,height:EG.getSize(this.dBody).outerHeight+EG.getSize(this.dHead).outerHeight+EG.getSize(this.dFoot).outerHeight})},getInnerHeight:function(){if(typeof(this.oHeight)=="number"){return EG.getSize(this.dPop).innerHeight-EG.getSize(this.dHead).outerHeight-EG.getSize(this.dFoot).outerHeight}else{return this.oHeight}},full:function(){if(!this._fulled){this.oParent=this.parent;this.oParentNode=this.getElement().parentNode;this._oWidth=this.width;this._oHeight=this.height;EG.getBody().appendChild(this.getElement());this.width="100%";this.height="100%";this.render();this._fulled=true}else{this.parent=this.oParent;this.width=this._oWidth;this.height=this._oHeight;this.oParentNode.appendChild(this.getElement());this.render();this._fulled=false}},render:function(){var c=this.parent||this.getElement().parentNode;var b=EG.getSize(c);EG.fit({element:this.element,dSize:{width:b.innerWidth,height:b.innerHeight},pSize:b});EG.css(this.element,"top:0px;left:0px");EG.fit({element:this.dPop,dSize:{width:this.width,height:this.height}});var a=this.isAutoHeight();if(!a){EG.fit({element:this.dBody,dSize:{height:(EG.getSize(this.dPop).innerHeight-EG.getSize(this.dHead).outerHeight-EG.getSize(this.dFoot).outerHeight)}})}var d=this.isAutoWidth();if(!d){EG.fit({element:this.dBody,dSize:{width:"100%"}})}if(this.items.length>0){this.doLayout()}b=EG.getSize(this.dPop);EG.fit({element:this.dHead,dSize:{width:b.innerWidth}});EG.fit({element:this.dFoot,dSize:{width:b.innerWidth}});EG.css(this.dBody,"position:relative;");if(this.lock){this.fullLock()}if(this.posFix){this.doPosFix()}},statics:{_events:{dCloser:{onmousedown:function(a){EG.Event.stopPropagation(a)},onmouseup:function(b){var a=this.me;a.close();EG.Event.stopPropagation(b)}},dFuller:{onmousedown:function(a){EG.Event.stopPropagation(a)},onmouseup:function(b){var a=this.me;a.full();EG.Event.stopPropagation(b)}}}}})})();(function(){EG.define("EG.ui.Tip",{extend:"EG.ui.Pop",config:{lock:false,cls:"eg_tip"},constructor:function(){this.initItem({});this.build()},build:function(){this.element=EG.CE({pn:EG.getBody(),tn:"div",style:"border:1px solid red;border-radius:2px;background:#FFFFC0;position:absolute;z-index:2",cn:[this.dIcon=EG.CE({tn:"div",style:EG.Style.c.dv}),this.dMessage=EG.CE({tn:"div",style:EG.Style.c.dv+";padding:5px"})]});EG.hide(this.element)},error:function(b,a){this.message({message:b,target:a,type:"error"})},info:function(){this.message({message:msg,target:target,type:"info"})},message:function(c){c=c||{};var k=c.message,d=c.target,e=c.target;var i=c.autoclose||false;var b=c.closetime;if(b){i=true}this.dMessage.innerHTML=k;EG.show(this.element);var g=EG.Tools.getElementPos(d);var a=EG.getSize(d);var h=g.x,f=g.y;var j=EG.getSize(this.element);if((h+a.clientWidth+j.clientWidth)>screen.width){h=h+a.clientWidth-j.clientWidth;f=f+a.clientHeight}else{h=h+a.clientWidth}EG.css(this.element,"left:"+h+"px;top:"+f+"px")}});EG.onload(function(){EG.Tip=new EG.ui.Tip()})})();(function(){EG.define("EG.ui.Locker",{extend:"EG.ui.Dialog",config:{cls:"eg_locker",title:"提示",zIndex:2},constructor:function(a){this.callSuper([a]);EG.css(this.dBody,"text-align:center;overflow:auto");this._lock=false},build:function(){this.callSuper("build");var a=this.dBody;this.dType=EG.CE({pn:a,tn:"div",cls:this.cls+"-type"});this.dWait=EG.CE({pn:a,tn:"div",cls:this.cls+"-wait",innerHTML:"正在加载..."})},lock:function(a){if(this._lock){return}a=EG.n2d(a,true);if(a){this.open()}else{this._lock=false;this.close()}},wait:function(a){this.message({message:a,closeable:false})},message:function(a){a=a||{};var e="";if(typeof(a)=="string"){e=a}else{e=a.message||"请稍等..."}if(!a.force&&this._lock){return}var c=a.type;if(c){EG.setCls(this.dType,["type","type-"+c],this.cls);EG.show(this.dType)}else{EG.hide(this.dType)}EG.setCls(this.dWait,["wait","fontM"],this.cls);this.dWait.innerHTML=e;var g=a.closeable!=null?a.closeable:true;var f=a.autoclose||false;var b=a.closetime;if(b){f=true}var h=a.callback;if(!g||f){this.setCloseable(false)}else{this.setCloseable(true)}this.open();EG.Style.fade(this.dPop,0,90,null,10);if(f){if(b==null){b=1200}var d=this;setTimeout(function(){EG.Style.fade(d.dPop,90,0,function(){d.lock(false);if(h){h()}},20)},b)}}});EG.onload(function(){EG.Locker=new EG.ui.Locker({width:Math.min(500,document.documentElement.clientWidth),height:Math.min(120,document.documentElement.clientHeight),renderTo:EG.getBody()});EG.lock=function(a){EG.Locker.lock(a)};EG.message=function(a){EG.Locker.message(a)};EG.wait=function(a){EG.Locker.wait(a)}})})();(function(){EG.ui.Option=function(b){this.btns=b.btns;this.pop=new EG.ui.Pop({closeable:false});this.element=EG.CE({tn:"div",style:"padding:10px"});this.pop.getElement().appendChild(this.element);if(this.btns){this.setBtns(this.btns)}document.body.appendChild(this.element)};EG.ui.Option.prototype={};var a=EG.ui.Option;EG.ui.Option.prototype.setTextactions=function(b){for(var d=0,c=b.length;d<c;d++){}};EG.ui.Option.prototype.open=function(){this.pop.open()};EG.ui.Option.prototype.close=function(){this.pop.close()};EG.ui.Option.prototype.setBtns=function(d){for(var c=0,b=d.length;c<b;c++){this.element.appendChild(d[c].getElement())}}})();(function(){EG.define("EG.ui.Layout",{statics:{layoutManagers:{},create:function(b,a){if(EG.String.isString(b)){b={type:b}}var c=EG.ui.layout[EG.Word.first2Uppercase(b.type)+"Layout"];if(!c){throw new Error("EG.ui.Layout#create:该布局器无法识别:"+b.type)}return new c(b,a)},regist:function(b,a){EG.ui.Layout.layoutManagers[b]=a},sizeDesc:function(a){var b={};b.ow=a.getOWidth();b.oh=a.getOHeight();b.isWA=a.isContainer&&a.isAutoWidth();b.isHA=a.isContainer&&a.isAutoHeight();b.isWP=(typeof(b.ow)=="string"&&b.ow.lastIndexOf("%")>=0);b.isHP=(typeof(b.oh)=="string"&&b.oh.lastIndexOf("%")>=0);b.isWE=b.ow==null;b.isHE=b.oh==null;b.isWN=(typeof(b.ow)=="number");b.isHN=(typeof(b.ow)=="number");return b},renderItems:function(d){for(var b=0,a=d.items.length;b<a;b++){var c=d.items[b];c.render()}}},addOnLayout:false,doLayout:function(){},hideItems:function(){var a=[];for(var b=0;b<this.items.length;b++){if(!this.items[b].hidden){a.push(this.items[b])}}this.items=a}})})();(function(){EG.define("EG.ui.layout.DefaultLayout",{extend:"EG.ui.Layout",config:{centerChilds:false,middleChilds:false,horizontal:true},constructor:function(b,a){this.container=a;this.initConfig(b);this.force=this.centerChilds||this.middleChilds},doLayout:function(){this.items=this.container.items;this.hideItems();this.isCtWA=this.container.isAutoWidth();this.isCtHA=this.container.isAutoHeight();for(var b=0,a=this.items.length;b<a;b++){var c=this.items[b];c.render()}this.autoSize();if(this.centerChilds){EG.Style.centerChilds(this.container.getItemContainer(),this.horizontal)}if(this.middleChilds){EG.Style.middleChilds(this.container.getItemContainer(),this.horizontal)}},autoSize:function(){var b=this.container.isAutoWidth();var m=this.container.isAutoHeight();if(this.isCtWA||this.isCtHA){var g=-1,c=-1,e=-1,a=-1;for(var j=0,f=this.items.length;j<f;j++){var o=this.items[j];var d=EG.Tools.getElementPos(o.getElement());var q=o.getSize();g=g==-1?(d.x-q.marginLeft):Math.min(d.x-q.marginLeft,g);c=c==-1?(d.x-q.marginLeft+q.outerWidth):Math.max(d.x-q.marginLeft+q.outerWidth,c);e=e==-1?(d.y-q.marginTop):Math.min(d.y-q.marginTop,e);a=a==-1?(d.y-q.marginTop+q.outerHeight):Math.max(d.y-q.marginTop+q.outerHeight,a)}var n=Math.max(0,c-g);var k=Math.max(0,a-e);if(this.isCtWA){this.container.setInnerWidth(n)}if(this.isCtHA){this.container.setInnerHeight(k)}}}})})();(function(){EG.define("EG.ui.layout.BorderLayout",{extend:"EG.ui.Layout",constructor:function(c,b){this.container=b},getItem:function(c){for(var d=0,b=this.container.items.length;d<b;d++){if(this.container.items[d].region==c.region){return this.container.items[d]}}return null},doLayout:function(){this.init();if(this.isCtWA){this.setCtWidth()}if(this.isCtHA){this.setCtHeight()}this.setItemWidth(this.ctW);this.setItemHeight(this.ctH);EG.ui.Layout.renderItems(this);this.autoSize()},init:function(){this.items=this.container.items;this.hideItems();this.ctEle=this.container.getItemContainer();EG.css(this.ctEle,"position:absolute");this.itemT=this.itemB=this.itemC=this.itemL=this.itemR=null;this.isCtWA=this.container.isAutoWidth();this.isCtHA=this.container.isAutoHeight();this.hasItemWA=false;this.hasItemHA=false;this.hasMidWA=false;this.hasMidHA=false;this.hasMidWE=false;this.hasMidHE=false;this.hasMidWP=false;this.hasMidHP=false;this.hasMidWN=false;this.hasMidHN=false;this.ctW=this.container.getInnerWidth();this.ctH=this.container.getInnerHeight();this.mItems=[];for(var c=0,b=this.items.length;c<b;c++){var d=this.items[c];if(!d.region){throw new Error("BorderLayout#doLayout:无region信息")}var e=EG.ui.Layout.sizeDesc(d);var f=false;this.hasItemWA=this.hasItemWA||e.isWA;this.hasItemHA=this.hasItemHA||e.isHA;if(d.region=="top"){this.itemT=d}else{if(d.region=="bottom"){this.itemB=d}else{if(d.region=="center"){this.itemC=d;f=true}else{if(d.region=="left"){this.itemL=d;f=true}else{if(d.region=="right"){this.itemR=d;f=true}else{throw new Error("BorderLayout#doLayout:暂不支持"+d.region)}}}}}if(f){this.mItems.push(d);this.hasMidWA=this.hasMidWA||e.isWA;this.hasMidHA=this.hasMidHA||e.isHA;this.hasMidWE=this.hasMidWE||e.isWE;this.hasMidHE=this.hasMidHE||e.isHE;this.hasMidWP=this.hasMidWP||e.isWP;this.hasMidWP=this.hasMidWP||e.isHP;this.hasMidWN=this.hasMidWN||e.isWN;this.hasMidHN=this.hasMidHN||e.isHN}if(d.region=="center"){EG.css(d,"position:absolute;");if(d.setCollapseAble){d.setCollapseAble(false)}}else{EG.css(d,"position:absolute;"+d.region+":0px");if(d.collapseAble&&d.setCollapseBehavior){d.setCollapseBehavior(d.region)}}}this.refMW=false;this.refMH=false;if(this.mItems.length>0){this.refMW=this.isCtWA&&(!this.hasMidWE&&!this.hasMidWP);this.refMH=this.isCtHA&&(this.hasMidHN||this.hasMidHA)}},setCtWidth:function(){this.ctW=0;if(this.refMW){if(!this.hasMidWA){var c=0;for(var b=0;b<this.mItems.length;b++){c+=this.mItems[b].getOWidth()}this.ctW=c}else{this.ctW=-1}}if(this.itemT&&this.ctW>=0&&this.itemT.getOWidth()!=null){this.ctW=this.itemT.isContainer&&this.itemT.isAutoWidth()?-1:Math.max(this.ctW,this.itemT.getOWidth())}if(this.itemB&&this.ctW>=0&&this.itemB.getOWidth()!=null){this.ctW=this.itemB.isContainer&&this.itemB.isAutoWidth()?-1:Math.max(this.ctW,this.itemB.getOWidth())}},setCtHeight:function(){this.ctH=0;if(this.refMH){if(!this.hasMidHA){this.ctH=0;var b=0;for(var c=0;c<this.mItems.length;c++){var d=this.mItems[c].getOHeight();if(d==null){continue}if(typeof(d)!="number"){throw new Error("BorderLayout#init:该处中间组件高度不能为非数字."+d)}b=Math.max(d,b)}this.ctH=b}else{this.ctH=-1}}if(this.itemT&&this.ctH>=0){if(typeof(this.itemT.getOHeight())!="number"){throw new Error("BorderLayout#init:该处中间组件高度不能为非数字.")}this.ctH=this.itemT.isContainer&&this.itemT.isAutoHeight()?-1:(this.ctH+this.itemT.getOHeight())}if(this.itemB&&this.ctH>=0){if(typeof(this.itemB.getOHeight())!="number"){throw new Error("BorderLayout#init:该处中间组件高度不能为非数字.")}this.ctH=this.itemB.isContainer&&this.itemB.isAutoHeight()?-1:(this.ctH+this.itemB.getOHeight())}},setItemWidth:function(h,c){if(this.mItems.length>0&&(c||!this.hasMidWA)){var i=function(m){if(!m){return 0}var l=m.getOWidth();var f=-1;if(l==null){f=-1}else{if(l=="auto"){if(c){f=m.getSize().outerWidth}else{throw new Error("意料之外的异常")}}else{if(typeof(l)=="string"&&l.lastIndexOf("%")>=0){if(h>0){f=a(l,h)}}else{if(typeof(l)=="number"){f=l}}}}return f};var e=i(this.itemL);var k=i(this.itemC);var b=i(this.itemR);if(k<0){if(e<0&&b<0){k=h/3;e=h/3;b=h/3}else{if(e>=0&&b>=0){k=h-e-b}else{if(e<0&&b>=0){var j=h-b;k=0.5*j;e=0.5*j}else{if(b<0){var j=h-e;k=0.5*j;b=0.5*j}}}}}else{if(e<0&&b<0){var j=h-k;e=0.5*j;b=0.5*j}else{if(e<0){e=h-k-b}else{if(b<0){b=h-k-e}}}}e=parseInt(e);k=parseInt(k);b=parseInt(b);if(this.itemL&&e>=0){this.itemL.width=e}if(this.itemC&&k>=0){this.itemC.width=k;var d=e>=0?e:0;EG.css(this.itemC,"left:"+d+"px")}if(this.itemR&&b>=0){this.itemR.width=b}}var g=function(l,f){if(!l||f<0||l.getOWidth()=="auto"){return}l.width=f};g(this.itemT,h);g(this.itemB,h)},setItemHeight:function(b,c){if(!c&&this.hasItemHA){return}var j=-1;if(this.mItems.length>0){for(var g=0;g<this.mItems.length;g++){var n=this.mItems[g];var k=n.getOHeight();if(k==null){continue}if(n.isContainer&&n.isAutoHeight()){if(c){k=n.getSize().outerHeight}else{throw new Error("非正常异常")}}else{k=a(k,this.ctH)}j=Math.max(j,k)}}else{j=0}var l=function(o){if(!o){return 0}var i=o.getOHeight();var f=-1;if(i==null){f=-1}else{if(i=="auto"){if(c){f=o.getSize().outerHeight}else{throw new Error("意料之外的异常3")}}else{if(typeof(i)=="string"&&i.lastIndexOf("%")>=0){if(b>0){f=a(i,b)}}else{if(typeof(i)=="number"){f=i}}}}return f};var m=l(this.itemB);var d=l(this.itemT);if(j<0){if(d<0&&m<0){j=b/3;d=b/3;m=b/3}else{if(d>=0&&m>=0){j=b-m-d}else{if(d<0){var e=b-m;j=e*0.5;d=e*0.5}else{if(m<0){var e=b-d;j=e*0.5;m=e*0.5}}}}}else{if(d<0&&m<0){var e=b-j;d=e*0.5;m=e*0.5}else{if(d<0){d=b-j-m}else{if(m<0){m=b-j-d}}}}j=parseInt(j);m=parseInt(m);d=parseInt(d);if(this.itemT&&d>=0){this.itemT.height=d}if(this.itemB&&m>=0){this.itemB.height=m}if(this.mItems.length>0&&j>=0){for(var g=0;g<this.mItems.length;g++){var n=this.mItems[g];n.height=j;EG.css(n,"top:"+d+"px")}}},autoSize:function(){if(this.isCtWA||this.isCtHA){this.ctW=0;if(this.mItems.length>0&&this.refMW){var g=0;for(var d=0;d<this.mItems.length;d++){var f=this.mItems[d];if(f.isContainer&&f.isAutoWidth()){g+=f.getSize().outerWidth}else{g+=f.getOWidth()}}this.ctW=g}if(this.itemT&&this.itemT.getOWidth()!=null){var c=this.itemT.isContainer&&this.itemT.isAutoWidth()?this.itemT.getSize().outerWidth:this.itemT.getOWidth();this.ctW=Math.max(this.ctW,c)}if(this.itemB&&this.itemB.getOWidth()!=null){var c=this.itemB.isContainer&&this.itemB.isAutoWidth()?this.itemB.getSize().outerWidth:this.itemB.getOWidth();this.ctW=Math.max(this.ctW,c)}this.ctH=0;var b=0;for(var d=0;d<this.mItems.length;d++){var f=this.mItems[d];var e=f.getOHeight();if(e==null){continue}if(e=="auto"){e=f.getSize().outerHeight}else{if(typeof(e)=="string"&&e.lastIndexOf("%")>=0){if(this.isCtHA){throw new Error("意料之外的异常4")}e=a(e,this.ctH)}else{if(typeof(e)=="number"){}}}b=Math.max(e,b)}this.ctH=b;if(this.itemT&&this.itemT.getOHeight()!=null){this.ctH+=this.itemT.isContainer&&this.itemT.isAutoHeight()?this.itemT.getSize().outerHeight:this.itemT.getOHeight()}if(this.itemB&&this.itemB.getOHeight()!=null){this.ctH+=this.itemB.isContainer&&this.itemB.isAutoHeight()?this.itemB.getSize().outerHeight:this.itemB.getOHeight()}if(this.isCtWA){this.container.setInnerWidth(this.ctW)}if(this.isCtHA){this.container.setInnerHeight(this.ctH)}}if(this.hasItemWA){this.setItemWidth(this.ctW,true)}if(this.hasItemHA){this.setItemHeight(this.ctH,true)}if(this.hasItemWA||this.hasItemHA){EG.ui.Layout.renderItems(this)}},renderItems:function(){for(var c=0,b=this.items.length;c<b;c++){var d=this.items[c];d.render()}}});var a=EG.Style.size2Num})();(function(){EG.define("EG.ui.layout.TableLayout",{extend:"EG.ui.Layout",config:{maxRow:0,maxCol:0,cellSpacing:0,cellPadding:0,border:0,style:null},constructor:function(b,a){this.container=a;this.initConfig(b);this.addOnLayout=true},getItem:function(a){return EG.Array.get(a)},fixPos:function(){for(var b=0,a=this.items.length;b<a;b++){var c=this.items[b].pos||[b,0];if(!EG.isArray(c)){throw new Error("EG.ui.layout#fixPos:item的pos类型需为数组")}if(c.length==0){c=[b,0]}else{if(c.length==1){c=[c[0],0]}else{if(c.length==2){}else{throw new Error("EG.ui.layout#fixPos:item的pos长度最大为2")}}}this.maxRow=Math.max(c[0]+1,this.maxRow);this.maxCol=Math.max(c[1]+1,this.maxCol);this.items[b].pos=c}},resetTable:function(){EG.DOM.removeAllRows(this.tbody);for(var a=0;a<this.maxRow;a++){var b=EG.CE({pn:this.tbody,tn:"tr"});for(var d=0;d<this.maxCol;d++){EG.CE({pn:b,tn:"td",style:"overflow:hidden"})}}},putItems:function(){for(var b=0,a=this.items.length;b<a;b++){var d=this.items[b];var f=d.pos;var c=d.getElement();var e=this.tbody.childNodes[f[0]].childNodes[f[1]];if(d.vAlign){EG.css(e,"vertical-align:"+d.vAlign)}e.appendChild(c)}},autoSpan:function(){var l=this.tbody.childNodes;for(var g=0,i=l.length;g<i;g++){var h=l[g].childNodes;var a=0;var c=h.length;for(var f=c-1;f>=0;f--){if(h[f].innerHTML==""){a++;l[g].removeChild(h[f])}else{break}}if(h.length==0){continue}if(a>0){var e=h[h.length-1];e.colSpan=a+1}var d=parseInt(100/c);for(var f=0,b=h.length;f<b;f++){if(f==b-1){h[f].width=parseInt(((a>0)?(d*(a+1)):d))+"%"}else{h[f].width=d+"%"}}}},doLayout:function(){this.items=this.container.items;this.hideItems();var b=this.container.getItemContainer();if(!this.table){this.table=EG.CE({pn:b,tn:"table",style:"width:100%;table-layout:fixed;"+(this.style?this.style:""),cellPadding:this.cellPadding,cellSpacing:this.cellSpacing,border:this.border});this.tbody=EG.CE({pn:this.table,tn:"tbody",style:"width:100%;"})}this.fixPos();this.resetTable();this.putItems();this.autoSpan();for(var c=0,a=this.items.length;c<a;c++){var d=this.items[c];d.render()}this.autoSize()},autoSize:function(){var c=this.container.isAutoWidth();var a=this.container.isAutoHeight();if(c||a){var b=EG.getSize(this.table);if(c){this.container.setInnerWidth(b.outerWidth)}if(a){this.container.setInnerHeight(b.outerHeight)}}}})})();(function(){EG.define("EG.ui.layout.LineLayout",{extend:"EG.ui.Layout",config:{direct:"H",align:null},constructor:function(c,b){this.container=b;this.initConfig(c);if(!this.align){this.align=this.direct=="H"?"left":"top"}},getItem:function(b){return EG.Array.get(b)},doLayout:function(){this.items=this.container.items;this.hideItems();EG.css(this.container.getItemContainer(),"position:absolute");this.isCtWA=this.container.isAutoWidth();this.isCtHA=this.container.isAutoHeight();this.hasItemWA=false;this.hasItemHA=false;this.hasItemWN=false;this.hasItemHN=false;this.hasItemWE=false;this.hasItemHE=false;this.hasItemWP=false;this.hasItemHP=false;this.ctW=this.isCtWA?-1:this.container.getInnerWidth();this.ctH=this.isCtHA?-1:this.container.getInnerHeight();for(var k=0,f=this.items.length;k<f;k++){var q=this.items[k];var n=EG.ui.Layout.sizeDesc(q);this.hasItemWA=this.hasItemWA||n.isWA;this.hasItemHA=this.hasItemHA||n.isHA;this.hasItemWN=this.hasItemWN||n.isWN;this.hasItemHN=this.hasItemHN||n.isHN;this.hasItemWE=this.hasItemWE||n.isWE;this.hasItemHE=this.hasItemHE||n.isHE;this.hasItemWP=this.hasItemWP||n.isWP;this.hasItemHP=this.hasItemHP||n.isHP;if(this.direct=="H"){if(this.isCtWA&&(n.isWE||n.isWP)){throw new Error("EG.ui.layout.LineLayout:父组件宽度和子组件宽度不能同为空||百分比")}}else{if(this.isCtHA&&(n.isHE||n.isHP)){throw new Error("EG.ui.layout.LineLayout:父组件高度和子组件高度不能同为空||百分比")}}}if(this.direct=="H"){if(this.isCtHA&&(!this.hasItemHN&&!this.hasItemHA)){throw new Error("EG.ui.layout.LineLayout:横向时,父组件高度为自动时,子组件高度不能既没有固定也没有自动")}}else{if(this.isCtWA&&(!this.hasItemWN&&!this.hasItemWA)){throw new Error("EG.ui.layout.LineLayout:纵向时,父组件宽度为自动时,子组件宽度不能既没有固定也没有自动")}}var g=0,d=0,r=0,o=0;var e={};for(var k=0,f=this.items.length;k<f;k++){var q=this.items[k];var n=EG.ui.Layout.sizeDesc(q);e[k]=n;if(this.direct=="H"){if(!this.isCtWA&&n.isWP){q.width=a(q.getOWidth(),this.ctW)}}else{if(!this.isCtHA&&n.isHP){q.height=a(q.getOHeight(),this.ctH)}}if(n.isWA||n.isHA||this.isCtHA||this.isCtWA){q.render()}if(this.direct=="H"){if(this.isCtHA){if(n.isHA){g=Math.max(g,q.getSize().outerHeight)}else{if(n.isHN){g=Math.max(g,q.height)}}}}else{if(this.isCtWA){if(n.isWA){g=Math.max(g,q.getSize().outerWidth)}else{if(n.isWN){g=Math.max(g,q.width)}}}}if(this.direct=="H"){if(!n.isWE){o+=q.width}else{d++}}else{if(!n.isHE){o+=q.height}else{d++}}}if(this.direct=="H"){if(!this.isCtHA){g=this.ctH}if(d){r=parseInt((this.ctW-o)/d)}}else{if(!this.isCtWA){g=this.ctW}if(d){r=parseInt((this.ctH-o)/d)}}for(var k=0,f=this.items.length;k<f;k++){var q=this.items[k];var n=e[k];if(this.direct=="H"){q.height=g;if(n.isWE){q.width=r}}else{q.width=g;if(n.isHE){q.height=r}}}if(this.direct=="H"){if(this.isCtWA){var j=0;for(var k=0,f=this.items.length;k<f;k++){var q=this.items[k];var p=q.getSize().outerWidth;j+=p}this.container.setInnerWidth(j)}if(this.isCtHA){this.container.setInnerHeight(g)}}else{if(this.isCtHA){var c=0;for(var k=0,f=this.items.length;k<f;k++){var q=this.items[k];var m=q.getSize().outerHeight;c+=m}this.container.setInnerHeight(c)}if(this.isCtWA){this.container.setInnerWidth(g)}}var b=0;for(var k=0,f=this.items.length;k<f;k++){var q=this.items[k];q.render();if(this.direct=="H"){EG.css(q,"position:absolute;"+this.align+":"+b+"px");b+=q.getSize().outerWidth}else{EG.css(q,"position:absolute;"+this.align+":"+b+"px");b+=q.getSize().outerHeight}}this.autoSize()},autoSize:function(){var k=this.container.isAutoWidth();var d=this.container.isAutoHeight();if(k||d){var g=0,c=0;for(var f=0,b=this.items.length;f<b;f++){var j=this.items[f];var e=EG.getSize(j);if(this.direct=="V"){if(d){g+=e.outerHeight}if(k){c=Math.max(c,e.outerWidth)}}else{if(d){g=Math.max(g,e.outerHeight)}if(k){c+=e.outerWidth}}}if(k){this.container.setInnerWidth(c)}if(d){this.container.setInnerHeight(g)}}}});var a=EG.Style.size2Num})();(function(){EG.define("EG.ui.Panel",{extend:"EG.ui.Container",constructor:function(a){this.callSuper([a])}})})();(function(){EG.define("EG.ui.XPanel",{extend:"EG.ui.Panel",config:{cls:"eg_xpanel",showTitle:true,showExpand:true,showBorder:true,title:null,collapseBehavior:"top",collapseAble:false,collapsed:false,barConfig:null,bodyStyle:null,headStyle:null},constructor:function(a){this.callSuper([a]);this.setCollapseAble(this.collapseAble)},build:function(){var a=this;this.element=EG.CE({tn:"div",cn:[this.dHead=EG.CE({tn:"div",cls:this.cls+"-dHead",cn:[this.dCollapse=EG.CE({tn:"div",cls:this.cls+"-dCollapse "+this.cls+"-dCollapse-top",onclick:function(){var b=EG.Style.isHide(a.dBody);a.collapse(!b)}}),this.dTitle=EG.CE({tn:"div",cls:this.cls+"-dTitle"})]}),this.dBody=EG.CE({tn:"div",cls:this.cls+"-dBody"})]});if(this.title){this.setTitle(this.title)}if(this.barConfig){this.setBar(this.barConfig)}if(this.bodyStyle){EG.css(this.dBody,this.bodyStyle)}if(this.headStyle){EG.css(this.dHead,this.headStyle)}},setBar:function(a){if(!this.dBar){this.dBar=new EG.ui.Panel({cls:this.cls+"-dBar"});this.dHead.appendChild(this.dBar.getElement())}this.dBar.clear();this.dBar.addItem(a)},render:function(){if(this.element.parentNode==EG.getBody()){EG.css(EG.getBody(),"margin:0px;padding:0px;width:100%;height:100%");EG.css(this.element,"position:absolute;left:0px;top:0px;")}EG.fit(this);var b={width:"100%"};if(this.collapsed){b.height="100%";EG.hide(this.dBody)}else{EG.show(this.dBody)}EG.hide(this.dHead);EG.fit({element:this.dHead,dSize:b});EG.show(this.dHead);if(!this.collapsed){if(this.dBar){this.dBar.width=EG.getSize(this.dHead).innerWidth-EG.getSize(this.dTitle).outerWidth-EG.getSize(this.dCollapse).outerWidth;this.dBar.height=EG.getSize(this.dHead).innerHeight;this.dBar.render()}}if(!this.collapsed){var a=EG.getSize(this.dHead);EG.fit({element:this.dBody,dSize:{width:"100%",height:(EG.getSize(this.element).innerHeight-a.outerHeight)}});if(this.items.length>0){this.doLayout()}}else{}},getOHeight:function(){return this.oHeight},getOWidth:function(){if(this.collapsed){var a=EG.getSize(this.element);return a.outerWidth-a.innerWidth+EG.getSize(this.dCollapse).outerWidth}else{return this.oWidth}},getItemContainer:function(){return this.dBody},setCollapseAble:function(a){this.collapseAble=a;if(!this.collapseAble){EG.hide(this.dCollapse)}},setCollapseBehavior:function(a){this.collapseBehavior=a;this.refreshCollapseCln(this.collapsed)},refreshCollapseCln:function(d){var a=this.collapseBehavior;var c=false;if(d){switch(this.collapseBehavior){case"top":a="bottom";break;case"right":a="left";c=true;break;case"bottom":a="top";break;case"left":a="right";c=true;break}}EG.setCls(this.dCollapse,["dCollapse","dCollapse-"+a],this.cls);if(c){EG.css(this.dTitle,"writing-mode:lr-tb");if(this.dBar){EG.hide(this.dBar)}}else{EG.css(this.dTitle,"writing-mode:;");if(this.dBar){EG.show(this.dBar)}}},collapse:function(b){this.refreshCollapseCln(b);if(b){var a=EG.getSize(this.dBody);EG.hide(this.dBody);this._oWidth=this.oWidth;this._oHeight=this.oHeight;if(EG.$in(this.collapseBehavior,["top","bottom"])){this.oHeight=this.height-a.outerHeight}else{if(EG.$in(this.collapseBehavior,["left","right"])){this.oWidth=20;EG.css(this.dHead,"overflow:hidden;writing-mode:lr-tb;")}}}else{this.oWidth=this._oWidth;this.oHeight=this._oHeight;EG.show(this.dBody);EG.css(this.dHead,"height:auto;")}this.collapsed=b;if(this.pItem){this.pItem.render()}},setTitle:function(a){this.title=a;this.dTitle.innerHTML=this.title},setInnerHeight:function(b){EG.Item.pack({pEle:this.dBody,height:b});var a=EG.Item.pack({pEle:this.element,height:EG.getSize(this.dBody).outerHeight+EG.getSize(this.dHead).outerHeight});this.height=a.height},getInnerHeight:function(){return EG.getSize(this.element).innerHeight-EG.getSize(this.dHead).outerHeight}})})();(function(){EG.define("EG.ui.TabPanel",{extend:"EG.ui.Container",config:{runOnSelectOnBuild:true,cls:"eg_tabPanel",direct:"top"},constructor:function(a){this.curIdx=-1,this.panels=[];this.tabs=[];this.callSuper([a])},afterBuild:function(){if(this.itemsConfig&&this.itemsConfig.length>0){this.add(this.itemsConfig,true);this.select(0)}},build:function(){this.element=EG.CE({tn:"div",cn:[this.dPanels=EG.CE({tn:"div",cls:this.cls+"-panels"+this.direct}),this.dTabs=EG.CE({tn:"div",cls:this.cls+"-tabs"+this.direct})]})},render:function(){EG.ui.Item.fixBody(this.element);EG.fit(this);this.size=EG.getSize(this.element);if(this.direct=="top"||this.direct=="bottom"){EG.fit({element:this.dTabs,dSize:{width:"100%"},pSize:{width:this.size.innerWidth},type:"width"});this.tabsSize=EG.getSize(this.dTabs);EG.css(this.dTabs,"position:absolute;"+this.direct+":0px;left:0px");this.tabsSize=EG.getSize(this.dTabs);EG.fit({element:this.dPanels,pSize:{width:this.size.innerWidth,height:this.size.innerHeight-this.tabsSize.outerHeight}});this.panelsSize=EG.getSize(this.dPanels);EG.css(this.dPanels,"position:absolute;"+this.direct+":"+this.tabsSize.outerHeight+"px;left:0px")}else{if(this.direct=="left"||this.direct=="right"){EG.fit({element:this.dTabs,dSize:{height:this.size.innerHeight},pSize:this.size,type:"height"});EG.css(this.dTabs,"position:absolute;"+this.direct+":0px;top:0px");this.tabsSize=EG.getSize(this.dTabs);EG.fit({element:this.dPanels,pSize:{width:this.size.innerWidth-this.tabsSize.outerWidth,height:this.size.innerHeight}});this.panelsSize=EG.getSize(this.dPanels);EG.css(this.dPanels,"position:absolute;"+this.direct+":"+this.tabsSize.outerWidth+"px;top:0px")}}this.doLayout()},getElementTabs:function(){return this.dTabs},getElementPanels:function(){return this.dPanels},add:function(c,g){if(g==null){g=true}var b=(!EG.isArray(c))?[c]:c;var f,a;for(var e=0,d=b.length;e<d;e++){c=b[e];if(c.panel["width"]==null){c.panel["width"]="100%"}if(c.panel["height"]==null){c.panel["height"]="100%"}c.tab["clsPre"]=this.cls+"-tabs"+this.direct;c.panel["className"]=this.cls+"-panels-panel";f=new EG.ui.Tab(this,c.tab);a=new EG.ui.Panel(c.panel);this.tabs.push(f);this.panels.push(a);this.dTabs.appendChild(f.getElement());this.dPanels.appendChild(a.getElement());this.items.push(a)}this.select(f);return f},close:function(a){var c;if(a instanceof EG.ui.Tab){c=a;a=this.getTabIdx(c)}else{c=EG.Array.get(this.tabs,a)}var d=c.getPanel();var b=(a==this.curIdx);c.destroy();d.destroy();this.dTabs.removeChild(c.element);this.dPanels.removeChild(d.getElement());EG.Array.del(this.items,a);EG.Array.del(this.tabs,a);EG.Array.del(this.panels,a);if(!b){return}if(a>=this.panels.length){a=this.panels.length-1}if(a>=0){this.select(a)}},doSelect:function(f,c){var a=-1;for(var e=0,b=this.panels.length;e<b;e++){var g=this.panels[e];var d=this.tabs[e];if(d!=f){EG.setCls(d.element,"tab",this.cls+"-tabs"+this.direct);EG.hide(g.getElement())}else{a=e}}EG.setCls(this.tabs[a].element,["tab","selected"],this.cls+"-tabs"+this.direct);EG.show(this.panels[a].getElement());if(!c){this.panels[a].render()}this.curIdx=a},select:function(a){var b=(a instanceof EG.ui.Tab)?a:EG.Array.get(this.tabs,a);b.select()},getTabs:function(){return this.tabs},getPanels:function(){return this.panels},getPanel:function(a){return EG.Array.get(this.panels,a)},getTab:function(a){return EG.Array.get(this.tabs,a)},getTabIdx:function(b){for(var a=0;a<this.tabs.length;a++){if(this.tabs[a]==b){return a}}},getSelectedIdx:function(){return this.curIdx},getSelectedTab:function(){return this.getTab(this.curIdx)},doLayout:function(){if(!this.element.parentNode){return}if(this.getSelectedIdx<0){return}var a=this.panels[this.getSelectedIdx()];if(a==null){return}a.pSize=this.panelsSize;a.render()},destroy:function(){for(var a=0;a<this.tabs.length;a++){this.tabs[a].destroy()}for(var a=0;a<this.panels.length;a++){this.panels[a].destroy()}this.tabs=null;this.panels=null;this.items=null}})})();(function(){EG.define("EG.ui.Tab",{extend:"EG.ui.Item",config:{title:"选项卡",closeable:false,onclick:null,onselect:null,onclose:null,afterselect:null,clsPre:null},constructor:function(b,a){this.pTabPanel=b;this.callSuper([a]);this.setCloseable(this.closeable)},build:function(){var a=EG.ui.Tab;this.element=EG.CE({tn:"div",cls:this.clsPre+"-tab "+this.clsPre+"-selected",me:this,cn:[this.dTitle=EG.CE({tn:"div",cls:this.pTabPanel.cls+"-tabs-tab-title",innerHTML:this.title}),this.dCloser=EG.CE({tn:"a",cls:this.pTabPanel.cls+"-tabs-tab-closer",me:this,onclick:a._events.dCloser.onclick,onmouseover:a._events.dCloser.onmouseover,onmouseout:a._events.dCloser.onmouseout})],onclick:a._events.element.onclick})},setCloseable:function(a){if(a){EG.show(this.dCloser)}else{EG.hide(this.dCloser)}},doClick:function(){if(this.onclick){this.onclick.apply(this)}this.select()},setTitle:function(a){this.dTitle.innerHTML=a},getIdx:function(){return this.pTabPanel.getTabIdx(this)},select:function(){if(this.onselect){this.onselect.apply(this)}this.pTabPanel.doSelect(this);if(this.afterselect){this.afterselect.apply(this)}},isSelected:function(){return this.pTabPanel.curIdx==this.getIdx()},close:function(){if(this.onclose){this.onclose.apply(this)}this.pTabPanel.close(this)},getPanel:function(){return this.pTabPanel.getPanel(this.getIdx())},statics:{_events:{element:{onclick:function(b){var a=this.me;a.doClick();EG.Event.stopPropagation(b)}},dCloser:{onclick:function(b){var a=this.me;a.close();EG.Event.stopPropagation(b)},onmouseover:function(){var a=this.me;EG.setCls(this,["tabs-tab-closer","tabs-tab-closer_on"],a.pTabPanel.cls)},onmouseout:function(){var a=this.me;EG.setCls(this,["tabs-tab-closer"],a.pTabPanel.cls)}}}}})})();(function(){EG.define("EG.ui.Tree",{extend:"EG.ui.Item",config:{rootTitle:"根目录",multiple:false,usebox:false,dragable:false,cls:"eg_tree",ondrag:null,deSelectable:true,onclick:null},constructor:function(b){a.load();this.callSuper([b]);if(this.multiple){this.usebox=true}this.rootNode=new EG.ui.TreeNode({title:this.rootTitle,root:true,onclick:this.onclick,onclickSrc:this.onclickSrc},this);this.rootNode.setClassNamePre(this.cls+"-");if(!this.dragable){EG.hide(this.rootNode.dInsert)}EG.CE({pn:this.element,ele:this.rootNode.getElement(),style:"margin-left:0px"});if(!this.box){EG.hide(this.rootNode.box.getElement())}this.reset()},build:function(){this.element=EG.CE({tn:"div",cls:this.cls,unselectable:"on",onmousemove:function(){if(a.curDrag!=null&&a.curDrag.style.display!="none"){EG.css(a.curDrag,"top:"+(event.clientY+10)+"px;left:"+(event.clientX+10)+"px;")}},onselectstart:function(){return false}})},reset:function(){this.treeNodes=[];if(this.rootNode.selected){this.rootNode.blur()}this.selectedNode=null;this.selectedNodes=[];EG.DOM.removeChilds(this.rootNode.dChildNodes)},render:function(){EG.fit(this)},add:function(b){EG.ui.TreeNode.prototype.add.apply(this.rootNode,arguments)},appendChild:function(b){b.tree=this;this.childNodes.push(b)},getSelected:function(){return this.multiple?this.selectedNodes:this.selectedNode},getElement:function(){return this.element},getRootNode:function(){return this.rootNode},removeAll:function(){this.rootNode.removeChilds()},registNode:function(b){this.treeNodes.push(b);b.tree=this;b.setClassNamePre(this.cls+"-")},ungistNode:function(b){EG.Array.remove(this.treeNodes,b)},expandAll:function(){for(var c=0,b=this.treeNodes.length;c<b;c++){this.treeNodes[c].expand()}},collapseAll:function(){for(var c=0,b=this.treeNodes.length;c<b;c++){this.treeNodes[c].collapse()}},expandLv:function(b){this.collapseAll();var c=function(f,g){f.expand();if(g>=b){return}g++;if(f.childNodes.length>0){for(var e=0,d=f.childNodes.length;e<d;e++){c(f.childNodes[e],(g))}}};c(this.getRootNode(),1)},deSelect:function(){if(this.multiple){if(!this.selectedNodes){return}for(var b=this.selectedNodes.length-1;b>=0;b--){this.selectedNodes[b].select(false)}}else{if(!this.selectedNode){return}this.selectedNode.select(false)}},expandChain:function(b){this.collapseAll();while((b=b.parentNode)!=null){b.expand()}},statics:{dragThread:null,curXY:null,curDrag:null,isDraging:function(){return EG.ui.Tree.curDrag!=null&&!EG.Style.isHide(EG.ui.Tree.curDrag)},loaded:false,load:function(){if(a.loaded){return}EG.bindEvent(EG.doc,"mouseup",function(){if(a.dragThread!=null){window.clearTimeout(a.dragThread)}if(a.curDrag){EG.hide(a.curDrag)}});a.loaded=true}}});var a=EG.ui.Tree;EG.ui.Item.regist("tree",a)})();(function(){EG.define("EG.ui.TreeNode",{extend:"EG.ui.Item",config:{title:"节点",value:null,showbox:false,root:false,onclick:null,ondrag:null,tree:null,cls:"eg_tree",titleStyle:null},constructor:function(d,c){this.callSuper([d]);this.tree=c||this.tree;this.parentNode=null;this.childNodes=[];this.ondrag=this.ondrag||(this.tree!=null?this.tree.ondrag:null);var e=this;this.box=new EG.ui.Box({showText:false,style:"display:inline",onclick:function(){e.select(!e.selected)}});this.dNode.appendChild(this.box.getElement());EG.css(this.box.getElement().childNodes[0],"margin-left:3px")},statics:{_events:{dExpandBtn:{onclick:function(){var c=this.me;c.changeCollapsed()}},dTitle:{ondblclick:function(){var c=this.me;c.changeCollapsed()},onclick:function(){var c=this.me;c.select(c.tree.deSelectable?!c.box.selected:true);if(c.onclick){c.onclick.apply(c.onclickSrc||c)}},onmouseup:function(){var c=this.me;if(b.isDraging()){b.curDrag.node.moveto("in",c)}},onmousedown:function(e){var d=this.me;if(!d.tree.dragable||d==d.tree.rootNode){return}b.curXY=[e.clientX,e.clientY];var c=d;b.dragThread=window.setTimeout(function(){if(b.curDrag==null){b.curDrag=EG.CE({pn:EG.getBody(),tn:"div",cls:"eg_tree_drager"})}b.curDrag.node=c;b.curDrag.innerHTML=c.title;EG.show(b.curDrag);EG.css(b.curDrag,"top:"+(b.curXY[1]+10)+"px;left:"+(b.curXY[0]+10)+"px;")},300)}},dInsert:{onmouseover:function(){var c=this.me;if(c==c.tree.rootNode){return}if(b.isDraging()){EG.css(this,"background-color:red;margin-left:7px;")}},onmouseout:function(){EG.css(this,"background-color:;margin-left:;")},onmouseup:function(){var c=this.me;if(c==c.tree.rootNode){return}if(b.isDraging()){b.curDrag.node.moveto("after",c)}}}}},build:function(){this.element=EG.CE({tn:"div",cn:[this.dNode=EG.CE({tn:"div",cn:[this.dExpandBtn=EG.CE({tn:"span",me:this,onclick:a._events.dExpandBtn.onclick}),this.dTitle=EG.CE({tn:"span",innerHTML:this.title,me:this,ondblclick:a._events.dTitle.ondblclick,onclick:a._events.dTitle.onclick,onmouseup:a._events.dTitle.onmouseup,onmousedown:a._events.dTitle.onmousedown})]}),this.dChildNodes=EG.CE({tn:"div"}),this.dInsert=EG.CE({tn:"div",me:this,onmouseover:a._events.dInsert.onmouseover,onmouseout:a._events.dInsert.onmouseout,onmouseup:a._events.dInsert.onmouseup})]});if(this.titleStyle){EG.css(this.dTitle,this.titleStyle)}},doClick:function(){EG.Event.fireEvent(this.dTitle,"click")},setTitle:function(c){this.title=c;this.dTitle.innerHTML=c},setValue:function(c){this.value=c},getValue:function(){return this.value},select:function(c){if(c){this.focus();this.box.select(true);if(this.tree.multiple){if(!EG.Array.has(this.tree.selectedNodes,this)){this.tree.selectedNodes.push(this)}}else{if(this.tree.selectedNode!=null&&this.tree.selectedNode!=this){this.tree.selectedNode.select(false)}this.tree.selectedNode=this}}else{this.blur();this.box.select(false);if(this.tree.multiple){EG.Array.remove(this.tree.selectedNodes,this)}else{this.tree.selectedNode=null}}this.selected=c},setClassNamePre:function(c){this.element.className=c+"node";this.dNode.className=c+"node-dNode";this.dExpandBtn.className=c+"node-dNode-dExpandBtn";this.dTitle.className=c+"node-dNode-dTitle";this.dChildNodes.className=c+"node-dChildNodes";this.dInsert.className=c+"node-dInsert"},blur:function(){EG.css(this.dTitle,{backgroundColor:"",color:""})},focus:function(){EG.css(this.dTitle,{backgroundColor:"#3399ff",color:"white"})},isCollapsed:function(){return EG.Style.isHide(this.dChildNodes)},changeCollapsed:function(){if(this.isCollapsed()){this.expand()}else{this.collapse()}},expand:function(e){EG.show(this.dChildNodes);if(e){var f=[];var d=this;while(d.parentNode){f.push(d);d=d.parentNode}for(var c=f.length-1;c>=0;c--){f[c].expand()}}this.refreshCollapseElement()},collapse:function(){EG.hide(this.dChildNodes);this.refreshCollapseElement()},preNode:function(){var d=this.parentNode.childNodes;for(var c=0;c<d.length;c++){if(d[c]==this){return(c==0)?null:d[c-1]}}return null},nextNode:function(){var d=this.parentNode.childNodes;for(var c=0;c<d.length;c++){if(d[c]==this){return(c>=d.length-1)?null:d[c+1]}}return null},add:function(e,c){if(c==null){c=this.childNodes.length-1;this.childNodes.push(e);this.dChildNodes.appendChild(e.getElement())}else{this.childNodes=EG.Array.insert(this.childNodes,c+1,e);if(this.dChildNodes.childNodes.length>c+1){var d=this.dChildNodes.childNodes[c+1];this.dChildNodes.insertBefore(e.getElement(),d)}else{this.dChildNodes.appendChild(e.getElement())}}this.tree.registNode(e);e.parentNode=this;this.refreshCollapseElement();e.refreshCollapseElement();if(this.childNodes.length>1){this.childNodes[this.childNodes.length-2].refreshCollapseElement()}if(!this.tree.multiple){EG.hide(e.box.getElement())}},remove:function(d){if(d==null){d=true}this.removeChilds();var c=this.preNode();this.tree.ungistNode(this);EG.Array.remove(this.parentNode.childNodes,this);this.parentNode.dChildNodes.removeChild(this.getElement());if(d){this.parentNode.refreshCollapseElement();if(c){c.refreshCollapseElement()}}},removeChilds:function(d){if(d==null){d=true}for(var c=this.childNodes.length-1;c>=0;c--){this.childNodes[c].remove(false)}if(d){this.refreshCollapseElement()}},refreshCollapseElement:function(){EG.DOM.removeChilds(this.dExpandBtn);var d,c;if(this.isLeaf()){d=this.cls+"-node-l-"+(this.isLast()?"l":"t");c=this.cls+"-node-file"}else{if(this.isCollapsed()){d=this.cls+"-node-l-"+(this.isLast()?"lPlus":"tPlus");c=this.cls+"-node-folder"}else{d=this.cls+"-node-l-"+(this.isLast()?"lMinus":"tMinus");c=this.cls+"-node-openfolder";if(!this.isLast()){EG.setCls(this.dChildNodes,["node-dChildNodes","node-bgLine"],this.cls)}else{EG.setCls(this.dChildNodes,["node-dChildNodes"],this.cls)}}}if(!this.isRoot()){EG.CE({pn:this.dExpandBtn,tn:"div",cls:d})}EG.CE({pn:this.dExpandBtn,tn:"div",cls:c});if(!this.isLast()){EG.setCls(this.dInsert,["node-dInsert","node-bgLine"],this.cls)}else{EG.setCls(this.dInsert,["node-dInsert"],this.cls)}if(this.parentNode&&this.parentNode.isRoot()){EG.css(this.element,"margin-left:0px")}},isLast:function(){if(this.parentNode==null){return true}return this.parentNode.childNodes[this.parentNode.childNodes.length-1]==this},isFirst:function(){return this.parentNode.childNodes[0]==this},isLeaf:function(){return this.childNodes.length==0},isRoot:function(){return this.root},getIdx:function(){var e=this.parentNode.childNodes;for(var d=0,c=e.length;d<c;d++){if(e[d]==this){return d}}},moveto:function(g,f){if(this.ondrag){if(!this.ondrag.apply(this["ondragSrc"]||this,[this,g,f])){return}}if(this==f){return}var i=this.parentNode;var d=this.preNode(this);var e=this.nextNode(this);var k=null;var j=-1;var l=this.getIdx();if(g=="after"){j=f.getIdx();k=f.parentNode}else{if(g=="in"){k=f}}var h=false;var c=k;while((c=c.parentNode)&&c!=null&&c!=this.tree.rootNode){if(c==this){h=true;break}}if(h){throw new Error("不能移动到子节点")}this.remove();if(j<0){k.add(this)}else{if(i==k){if(l<j){j--}}k.add(this,j)}i.refreshCollapseElement();if(d){d.refreshCollapseElement()}if(e){e.refreshCollapseElement()}if(this.parentNode.isRoot()){EG.css(this.element,"margin-left:0px")}}});var a=EG.ui.TreeNode;var b=EG.ui.Tree})();(function(){EG.define("EG.ui.Button",{extend:"EG.ui.Item",config:{text:"",click:null,mouseover:null,mouseout:null,icon:null,cls:"eg_button",iconAble:true,menuConfig:null,iconOnly:false,textStyle:null},constructor:function(b){this.callSuper([b]);if(!this.icon||!this.iconAble){EG.hide(this.dIcon)}else{this.dIcon.className=this.cls+"-icon icon_"+this.icon}this.buildMenu();if(this.textStyle){this.setTextStyle(this.textStyle)}},build:function(){var b=this;var c=this.getClass();if(this.iconOnly){this.element=EG.CE({tn:"div",cls:this.cls,item:this,onclick:a._events.element.onclick,cn:[this.dIcon=EG.CE({tn:"a",title:this.text})]})}else{this.element=EG.CE({tn:"div",cls:this.cls,item:this,onclick:a._events.element.onclick,onmouseover:a._events.element.onmouseover,onmouseout:a._events.element.onmouseout,cn:[this.dOuter=EG.CE({tn:"div",cls:this.cls+"-outer",item:this,cn:[this.dIcon=EG.CE({tn:"div"}),this.dTitle=EG.CE({tn:"div",cls:this.cls+"-title",innerHTML:this.text}),this.dMulti=EG.CE({tn:"div",cls:this.cls+"-multi",onclick:a._events.dMulti.onclick,item:this})],onmouseover:c._events.outer.onmouseover,onmouseout:c._events.outer.onmouseout})]})}},setTextStyle:function(b){this.textStyle=b;EG.css(this.dTitle,this.textStyle)},setText:function(b){this.text=b;this.dTitle.innerHTML=b},buildMenu:function(){if(this.menuConfig&&this.menuConfig.length>0){this.dMenus=EG.CE({pn:this.element,tn:"div",cls:this.cls+"-menu",style:"position:absolute;z-index:1;overflow:hidden;"});for(var c=0,b=this.menuConfig.length;c<b;c++){var d=this.menuConfig[c];EG.CE({pn:this.dMenus,tn:"a",idx:c,innerHTML:d.text,href:"javascript:void(0)",cls:this.cls+"-mi",item:this,onclick:a._events.aMenuEle.onclick})}}else{if(this.dMulti){EG.hide(this.dMulti)}}if(this.dMenus){EG.hide(this.dMenus)}},render:function(){if(this.dMenus){var b=EG.getSize(this.element);EG.fit({element:this.dMenus,sSize:b,dSize:{width:b.outerWidth}})}},statics:{_events:{element:{onclick:function(c){var b=this.item;if(b.click){b.click.apply(b.clickSrc||b)}EG.Event.stopPropagation(c)},onmouseout:function(c){var b=this.item;if(!b.dMenus){return}if(b.outThread!=null){return}b.outThread=setTimeout(function(){EG.hide(b.dMenus)},10);EG.Event.stopPropagation(c)},onmouseover:function(c){var b=this.item;if(!b.dMenus){return}if(b.outThread!=null){clearTimeout(b.outThread);b.outThread=null}EG.Event.stopPropagation(c)}},outer:{onmouseover:function(){var b=this.item;this.className=b.cls+"-outer "+b.cls+"-on"},onmouseout:function(){var b=this.item;this.className=b.cls+"-outer"}},dMulti:{onclick:function(c){var b=this.item;EG.show(b.dMenus);EG.Event.stopPropagation(c)}},aMenuEle:{onclick:function(d){var b=this.item;var c=b.menuConfig[this.idx];c.click.apply(c.clickSrc||b);EG.hide(b.dMenus);EG.Event.stopPropagation(d)}}}}});var a=EG.ui.Button})();(function(){EG.define("EG.ui.Box",{extend:"EG.ui.Item",config:{text:"",value:"",cls:"eg_box",onselect:null,onclick:null,afterselect:null,selected:false,showText:true},constructor:function(b){this.callSuper([b]);if(!this.showText){EG.hide(this.dText)}},build:function(){this.element=EG.CE({tn:"div",cls:this.cls,item:this,onclick:a._events.element.onclick,cn:[this.dBox=EG.CE({tn:"a",cls:this.cls+"-b"}),this.dText=EG.CE({tn:"div",cls:this.cls+"-text",innerHTML:this.text})]})},select:function(c,b){if(b==null){b=true}if(b&&this.onselect){if(this.onselect.apply(this,[c])===false){return}}this.selected=c;EG.setCls(this.dBox,["b",this.selected?"select":"unselect"],this.cls);if(b&&this.afterselect){this.afterselect.apply(this,[c])}},deSelect:function(){this.selected=null;EG.setCls(this.dBox,["b","unselect"],this.cls)},setValue:function(b){this.value=b},getValue:function(){return this.value},render:function(){EG.fit(this);var c=EG.getSize(this.element).innerHeight;var b=parseInt((c-EG.getSize(this.dBox).outerHeight)/2);EG.css(this.dBox,"margin-top:"+b+"px;margin-bottom:"+b+"px");EG.css(this.dText,"line-height:"+c+"px;height:"+c+"px")},statics:{_events:{element:{onclick:function(){var b=this.item;if(b.onclick){b.onclick.apply(b)}else{b.select(!b.selected)}}}}}});var a=EG.ui.Box})();(function(){EG.define("EG.ui.BoxGroup",{extend:"EG.ui.Item",config:{multiple:false,onselect:null,onclick:null,onchange:null,afterselect:null,textvalues:[],cls:"eg_boxgroup",defValue:null,boxHeight:null},constructor:function(b){this.callSuper([b]);this.boxes=[];this.onchangeEvents=[];if(this.onchange!=null){this.bindOnchange(this.onchange)}this.buildBoxes();if(this.defValue){this.setValue(this.defValue)}},build:function(){this.element=EG.CE({tn:"div",cls:this.cls})},buildBoxes:function(){var e=this;for(var d=0,b=this.textvalues.length;d<b;d++){var c=this.textvalues[d];this.add({text:c[0],value:c[1],onclick:a._events.box.onclick,group:this,onselect:e.onselect,afterselect:e.afterselect})}},setValue:function(d,c){if(c==null){c=true}var b=this.getValue();if(this.multiple){EG.Array.each(this.boxes,function(){this.select(EG.Array.has(d,this.value))})}else{EG.Array.each(this.boxes,function(){this.select(this.value==d)})}if(!EG.Object.equals(b,d)&&c){this.doOnChange(d,b)}},getValue:function(){var c=[];for(var d=0,b=this.boxes.length;d<b;d++){var e=this.boxes[d];if(this.multiple){if(e.selected){c.push(e.value)}}else{if(e.selected){return e.value}}}if(this.multiple){return c}return null},getText:function(){var e=[];for(var c=0,b=this.boxes.length;c<b;c++){var d=this.boxes[c];if(this.multiple){if(d.selected){e.push(d.text)}}else{if(d.selected){return d.text}}}if(this.multiple){return e}return null},getSelectedBox:function(){var c=[];for(var d=0,b=this.boxes.length;d<b;d++){var e=this.boxes[d];if(this.multiple){if(e.selected){c.push(e)}}else{if(e.selected){return e}}}if(this.multiple){return c}return null},add:function(b){if(EG.isLit(b)){b=new EG.ui.Box(b)}b.pItem=this;this.boxes.push(b);this.element.appendChild(b.getElement())},getBoxes:function(){return this.boxes},bindOnchange:function(b){this.onchangeEvents.push(b)},doOnChange:function(d,b){for(var c=0;c<this.onchangeEvents.length;c++){this.onchangeEvents[c].apply(this,[d,b])}},render:function(){EG.fit(this);var c=EG.getSize(this.element).innerHeight;for(var b=0;b<this.boxes.length;b++){this.boxes[b].height=this.boxHeight!=null?this.boxHeight:c;this.boxes[b].render()}},setTextvalues:function(b){EG.Array.clear(this.boxes);this.textvalues=b;EG.DOM.removeChilds(this.element);this.buildBoxes()},statics:{_events:{box:{onclick:function(){var e=this.group;var c=this.group.getValue();var g=false;if(e.multiple){this.select(!this.selected);g=true}else{if(e.onclick){e.onclick()}else{if(!this.selected){g=true}for(var d=0,b=e.boxes.length;d<b;d++){if(this!=e.boxes[d]){e.boxes[d].select(false)}}this.select(true)}}var f=this.group.getValue();if(g){for(var d=0;d<e.onchangeEvents.length;d++){e.onchangeEvents[d].apply(e,[f,c])}}}}}}});var a=EG.ui.BoxGroup})();(function(){EG.define("EG.ui.Date",{extend:"EG.ui.Item",config:{fmt:"YMDHMS",maxLength:10,dateFmt:null,cls:"eg_date",onkeydown:null,onkeyup:null},constructor:function(b){this.callSuper([b]);if(this.dateFmt==null){if(this.fmt=="Y"){this.dateFmt="yyyy";this.maxLength=4}else{if(this.fmt=="YMD"){this.dateFmt="yyyy-MM-dd";this.maxLength=10}else{if(this.fmt=="YMDHMS"){this.dateFmt="yyyy-MM-dd HH:mm:ss";this.maxLength=20}else{throw new Error("暂不支持时间格式"+this.fmt)}}}}},build:function(){this.element=EG.CE({tn:"div",cls:this.cls,cn:[this.input=EG.CE({tn:"input",cls:this.cls+"-input",type:"text",maxLength:this.maxLength,length:this.maxLength,item:this,onclick:a._events.input.onclick})]});if(this.onkeyup){EG.Event.bindEvent(this.input,"onkeyup",this.onkeyup)}},setValue:function(b){EG.setValue(this.input,b)},getValue:function(){return EG.getValue(this.input)},render:function(){EG.fit(this);EG.fit({element:this.input,dSize:{width:"100%",height:"100%"},pSize:EG.getSize(this.element)})},statics:{_events:{input:{onclick:function(){var b=this.item;new WdatePicker({dateFmt:b.dateFmt,skin:"ext"})}}}}});var a=EG.ui.Date})();(function(){EG.define("EG.ui.Calander",{extend:"EG.ui.Item",config:{text:"",click:null,cls:"eg_calander",style:null},constructor:function(a){this.element=EG.CE({tn:"div"})}})})();(function(){EG.define("EG.ui.Editor",{extend:"EG.ui.Item",config:{pluginGroupName:"def",cls:"eg_editor",uploadPolicy:null,imgUploadPolicy:null,uploadAction:null,imgUploadAction:null,onUploaded:null,imgOnUploaded:null,uploadHandleType:null,deleteUpload:null,parent:null,imgPickers:null},constructor:function(b){this.initItem(b);this.pluginGroup=a.pluginGroups[this.pluginGroupName];if(typeof(this.onUploaded)=="string"){this.onUploaded=a.defOnUploaded}this.dToolbarButtons=null;this.dIframe=null;this.dSource=null;this.dCache=null;this.element=EG.CE({tn:"div",cls:this.cls,cn:[this.dMenuPanels=EG.CE({tn:"div"}),this.dToolbarButtons=EG.CE({tn:"div",cls:this.cls+"-toolbar"}),this.dHtml=EG.CE({tn:"div",cls:this.cls+"-dHtml",cn:[this.frame=EG.CE({tn:"iframe",frameBorder:"0",designMode:"on",style:"height:100%",item:this})]}),this.dCache=EG.CE({tn:"div",style:"display:none"})]});EG.css(this.element,this.style);this.initIframe();this.buildPlugins()},render:function(){EG.fit(this);var e=EG.getSize(this.element);EG.fit({element:this.dToolbarButtons,dSize:{width:"100%"},pSize:e,type:"height"});var c=EG.getSize(this.dToolbarButtons);EG.fit({element:this.dHtml,dSize:{width:"100%",height:e.innerHeight-c.outerHeight},pSize:e});for(var d=0,b=this.plugins.length;d<b;d++){this.plugins[d].render()}},plugins:[],pluginsMap:{},clickHandlers:[],dblclickHandlers:[],buildPlugins:function(){this.buildInParents=[];for(var g=0,c=this.pluginGroup.length;g<c;g++){var f=this.pluginGroup[g];var h=new a.pluginsMap[f](this);this.plugins.push(h);this.pluginsMap[f]=h;var b=h.getToolbarButton();if(b){this.dToolbarButtons.appendChild(b.getElement())}if(h.getMenuPanel){var e=h.getMenuPanel();if(e){if(h.buildInParent&&this.parent){var d=(this.parent.getElement)?this.parent.getElement():this.parent;d.appendChild(e.getElement());this.buildInParents.push(e)}else{this.dMenuPanels.appendChild(e.getElement())}}}}},getPlugin:function(b){return this.pluginsMap[b]},initIframe:function(){EG.bindEvent(this.frame,"load",a._events.iframe.load)},setContent:function(b){if(this.loaded){this.frame.contentWindow.document.body.innerHTML=b}else{this.cacheHTML=b}},setValue:function(k){var h=EG.CE({tn:"div",innerHTML:k});var l=["img","a"];for(var f=0;f<l.length;f++){var d=h.getElementsByTagName(l[f]);for(var e=0;e<d.length;e++){var b=d[e];var c;var g="";if(b.hasAttribute("srcUri")){g="src";c=b.getAttribute("srcUri")}else{if(b.hasAttribute("hrefUri")){g="href";c=b.getAttribute("hrefUri")}else{continue}}b.setAttribute(g,c)}}this.setContent(k)},getContent:function(){return this.frame.contentWindow.document.body.innerHTML},getValue:function(){return this.getContent()},focus:function(){if(EG.Browser.isChrome()){this.frame.contentWindow.document.body.focus()}else{if(EG.Browser.isIE()){this.frame.contentWindow.focus()}else{this.frame.focus()}}},hideMenus:function(){for(var d=0,b=this.plugins.length;d<b;d++){var e=this.plugins[d];if(!e.getMenuPanel){continue}var c=e.getMenuPanel();if(c){c.close()}}},htmlexec:function(c,b){this.focus();if(!b){if(EG.Browser.isIE()){this.frame.contentWindow.document.execCommand(c,false)}else{this.frame.contentWindow.document.execCommand(c,false,false)}}else{this.frame.contentWindow.document.execCommand(c,false,b)}this.focus()},pasteHTML:function(b){this.focus();if(EG.Browser.isIE()){this.getSelection().createRange().pasteHTML(b)}else{this.frame.contentWindow.document.execCommand("InsertHtml",false,b)}},getSelection:function(){if(EG.Browser.isIE()){return this.frame.contentWindow.document.selection}return this.frame.contentWindow.document.getSelection()},addResOnUploaded:function(b){var h=this;var d=b.ct;var g=b.r;var f=g.type;var c=g.file;var i=g.doDelete;var e=EG.CE({tn:"div",cls:this.cls+"-uploadLabel",style:EG.Style.c.dv+";min-width:40px;max-width:200px",onmouseover:a._events.dUploadLabel.onmouseover,onmouseout:a._events.dUploadLabel.onmouseout,cn:[{tn:"div",onclick:function(){var j;if(f=="image"){j=h.getPlugin("image");j.showMenuPanel();j.setImageForm({src:c.path})}else{if(f=="video"){j=h.getPlugin("video");j.showMenuPanel();j.setVideoForm(c)}else{if(f=="zip"){j=h.getPlugin("zip");j.showMenuPanel();j.setZipForm(c)}}}},innerHTML:c.name,style:EG.Style.c.dv+";cursor:pointer"},{tn:"a",cls:this.cls+"-uploadLabel-closer",onclick:function(){var j=this;i(function(){j.parentNode.parentNode.removeChild(j.parentNode)})}}]});d.appendChild(e)},destroy:function(){for(var b=0;b<this.buildInParents.length;b++){this.buildInParents[b].destroy();EG.DOM.remove(this.buildInParents[b].getElement())}},execute:function(c,b){var d=this.getPlugin(c);d.execute(b)},statics:{def:{fontSize:"14px"},pluginsMap:{},pluginGroups:{def:["bold","italic","underline","fontname","fontsize","color","textalign","list","indent","image","code"],simple:["bold","italic","underline","fontname","fontsize","color","textalign","list","indent"]},registPlugin:function(b,c){a.pluginsMap[b]=c},_events:{iframe:{load:function(){var b=this.item;this.doc=this.contentDocument||this.contentWindow.document;this.doc.body.designMode="on";this.doc.body.contentEditable=true;this.doc.body.style.fontSize=a.def.fontSize;EG.css(this.doc.body,"line-height:1.5;margin:0; padding:8px 8px;font-size:"+a.def.fontSize);b.loaded=true;if(b.cacheHTML!=null){this.contentWindow.document.body.innerHTML=b.cacheHTML}else{this.contentWindow.document.body.innerHTML="<p></p>"}this.contentWindow.document.editor=b;this.contentWindow.document.onclick=function(){b.hideMenus()};if(EG.Browser.isIE()){EG.bindEvent(this,"beforedeactivate",function(){var c=b.doc.selection.createRange();if(c.getBookmark){this.ieSelectionBookmark=c.getBookmark()}});EG.bindEvent(this,"activate",function(){if(this.ieSelectionBookmark){var c=b.doc.body.createTextRange();c.moveToBookmark(this.ieSelectionBookmark);c.select();this.ieSelectionBookmark=null}})}EG.bindEvent(this.doc,"keydown",function(d){if(d==null){d=window.event}var c=d.keyCode;if(d.ctrlKey){}else{if(d.shiftKey){}else{switch(c){case 13:}}}});EG.bindEvent(this.doc,"click",function(f){for(var d=0,c=b.clickHandlers.length;d<c;d++){b.clickHandlers[d](f)}});EG.bindEvent(this.doc,"dblclick",function(f){for(var d=0,c=b.dblclickHandlers.length;d<c;d++){b.dblclickHandlers[d](f)}})}},dUploadLabel:{onmouseover:function(){EG.show(this.childNodes[1])},onmouseout:function(){EG.hide(this.childNodes[1])}},dUploadName:{}}}});var a=EG.ui.Editor})();(function(){EG.define("EG.ui.editor.Plugin",{config:{buildInParent:false},getToolbarButton:function(){return this.toolbarButton},getMenuPanel:function(){return this.menuPanel},render:function(){}})})();(function(){EG.define("EG.ui.editor.ToolbarButton",{extend:"EG.ui.Item",config:{type:null,cls:null},constructor:function(b,a){this.initItem(a);this.editor=b;this.button=EG.CE({tn:"a",cls:b.cls+"-toolbar-"+this.cls,href:"javascript:void(0)"});if(a.click){EG.Event.bindEvent(this.button,"onclick",a.click)}this.element=this.button}})})();(function(){EG.define("EG.ui.editor.plugin.Bold",{extend:"EG.ui.editor.Plugin",constructor:function(b){this.editor=b;var c=this;this.toolbarButton=new EG.ui.editor.ToolbarButton(b,{type:"bold",click:function(){c.execute()},cls:"bold"})},execute:function(){this.editor.htmlexec("Bold")}});var a=EG.ui.editor.plugin.Bold;EG.ui.Editor.registPlugin("bold",a)})();(function(){EG.define("EG.ui.editor.plugin.Code",{extend:"EG.ui.editor.Plugin",constructor:function(b){this.editor=b;var c=this;this.codeModel=false;this.toolbarButton=new EG.ui.editor.ToolbarButton(b,{type:"code",click:function(){c.codeModel=!c.codeModel;c.execute(c.codeModel)},mouseover:function(){},cls:"code"});this.editPanel=EG.CE({pn:this.editor.dHtml,tn:"textarea",style:"width:100%;background:#FEFEFE;border:0px;margin:0px;padding:0px"});EG.hide(this.editPanel)},execute:function(e){if(e){EG.setValue(this.editPanel,this.editor.getContent());EG.css(this.editPanel,"height:"+this.editor.frame.clientHeight+"px;width:"+this.editor.frame.clientWidth+"px");EG.show(this.editPanel);EG.hide(this.editor.frame);var d=this.editor.dToolbarButtons.childNodes;for(var c=0,b=d.length;c<b;c++){if(d[c]!=this.toolbarButton.getElement()){EG.hide(d[c])}}}else{this.editor.setContent(EG.getValue(this.editPanel));EG.hide(this.editPanel);EG.show(this.editor.frame);var d=this.editor.dToolbarButtons.childNodes;for(var c=0,b=d.length;c<b;c++){EG.show(d[c])}}}});var a=EG.ui.editor.plugin.Code;EG.ui.Editor.registPlugin("code",a)})();(function(){EG.define("EG.ui.editor.plugin.Color",{extend:"EG.ui.editor.Plugin",constructor:function(b){this.editor=b;var c=this;this.toolbarButton=new EG.ui.editor.ToolbarButton(b,{type:"color",click:function(){c.editor.hideMenus();var d=c.toolbarButton.getElement();var e=EG.Tools.getElementPos(d,c.editor.getElement());e.y=d.clientHeight;EG.Style.moveTo(c.menuPanel.dPop,e);c.menuPanel.open()},mouseover:function(){},cls:"color"});this.buildMenuPanel()},execute:function(b){this.editor.htmlexec("ForeColor",b)},buildMenuPanel:function(){this.menuPanel=new EG.ui.Pop({closeable:true,lock:false,posFix:false,cls:"eg_pop_blank"});var m=this;var f;var b=EG.CE({tn:"table",cellSpacing:0,cellPadding:0,style:"float:left;border:0px;margin:0px",cn:[f=EG.CE({tn:"tbody"})]});var c=5;for(var e=0;e<16;e++){if(e%4==0){continue}var l=EG.CE({pn:f,tn:"tr"});for(var d=0;d<30;d++){var k=d%c;if(d%4==0){continue}var h=Math.floor(d/c)*3;var g=h+3;(function(){var i=a.wc((a.cnum[g]*k+a.cnum[h]*(c-k)),(a.cnum[g+1]*k+a.cnum[h+1]*(c-k)),(a.cnum[g+2]*k+a.cnum[h+2]*(c-k)),e);EG.CE({pn:l,tn:"td",cn:[{tn:"div",cls:m.editor.cls+"-toolbar-color-box",style:"background-color:"+i,onclick:function(){m.execute(i);m.menuPanel.close()},onmouseover:function(){EG.setCls(this,["toolbar-color-box","toolbar-color-boxOn"],m.editor.cls)},onmouseout:function(){EG.setCls(this,["toolbar-color-box"],m.editor.cls)}}]})})()}}this.menuPanel.addChildren(b)},statics:{hexch:["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],cnum:[1,0,0,1,1,0,0,1,0,0,1,1,0,0,1,1,0,1,1,0,0],colors:["#FF0000","#00FF00","#0000FF","#FFFF00","#00FFFF","#FF00FF"],toHex:function(d){var c,b,d=Math.round(d);b=d%16;c=Math.floor((d/16))%16;return(a.hexch[c]+a.hexch[b])},wc:function(e,d,c,f){e=((e*16+e)*3*(15-f)+128*f)/15;d=((d*16+d)*3*(15-f)+128*f)/15;c=((c*16+c)*3*(15-f)+128*f)/15;return"#"+a.toHex(e)+a.toHex(d)+a.toHex(c)}}});var a=EG.ui.editor.plugin.Color;EG.ui.Editor.registPlugin("color",a)})();(function(){EG.define("EG.ui.editor.plugin.Fontname",{extend:"EG.ui.editor.Plugin",constructor:function(b){this.editor=b;var c=this;this.toolbarButton=new EG.ui.editor.ToolbarButton(b,{type:"fontname",text:"字体",click:function(){c.editor.hideMenus();var d=c.toolbarButton.getElement();var e=EG.Tools.getElementPos(d,c.editor.getElement());e.y=d.clientHeight;EG.Style.moveTo(c.menuPanel.dPop,e);c.menuPanel.open()},mouseover:function(){},style:"font-size:12px",cls:"fontname"});this.buildMenuPanel()},execute:function(b){this.editor.htmlexec("Fontname",b)},buildMenuPanel:function(){this.menuPanel=new EG.ui.Pop({closeable:true,lock:false,posFix:false,cls:"eg_pop_blank"});var e=this;var f=EG.CE({tn:"div",style:""});for(var c=0,b=a.fontnames.length;c<b;c++){(function(){var d=a.fontnames[c];EG.CE({pn:f,tn:"a",cls:e.editor.cls+"-toolbar-fontname-box",style:"font-family:"+d,innerHTML:d,onclick:function(){e.execute(d);e.menuPanel.close()}})})()}this.menuPanel.addChildren(f)},statics:{fontnames:["微软雅黑","宋体","黑体","楷体_GB2312","隶书","幼圆","Arial","Arial Narrow","Arial Black","Comic Sans MS","Courier","System","Times New Roman"]}});var a=EG.ui.editor.plugin.Fontname;EG.ui.Editor.registPlugin("fontname",a)})();(function(){EG.define("EG.ui.editor.plugin.Fontsize",{extend:"EG.ui.editor.Plugin",constructor:function(b){this.editor=b;var c=this;this.toolbarButton=new EG.ui.editor.ToolbarButton(b,{type:"fontsize",click:function(){c.editor.hideMenus();var d=c.toolbarButton.getElement();var e=EG.Tools.getElementPos(d,c.editor.getElement());e.y=d.clientHeight;EG.Style.moveTo(c.menuPanel.dPop,e);c.menuPanel.open()},mouseover:function(){},cls:"fontsize"});this.buildMenuPanel()},execute:function(b){this.editor.htmlexec("FontSize",b)},buildMenuPanel:function(){this.menuPanel=new EG.ui.Pop({closeable:true,lock:false,posFix:false,cls:"eg_pop_blank"});var e=this;var f=EG.CE({tn:"div",style:""});for(var c=0,b=a.fontsizes.length;c<b;c++){(function(){var d=a.fontsizes[c];EG.CE({pn:f,tn:"a",cls:e.editor.cls+"-toolbar-fontsize-box",style:"font-size:"+(d+10)+"px",innerHTML:d+"号",onclick:function(){e.execute(d);e.menuPanel.close()}})})()}this.menuPanel.addChildren(f)},statics:{fontsizes:[1,2,3,4,5,6,7]}});var a=EG.ui.editor.plugin.Fontsize;EG.ui.Editor.registPlugin("fontsize",a)})();(function(){EG.define("EG.ui.editor.plugin.Image",{extend:"EG.ui.editor.Plugin",constructor:function(b){this.editor=b;var c=this;this.buildInParent=true;this.toolbarButton=new EG.ui.editor.ToolbarButton(b,{type:"image",click:function(){if(c.resPicker){c.resPicker.close()}c.showMenuPanel()},mouseover:function(){},cls:"image"});this.uploadPolicy=this.editor.imgUploadPolicy||this.editor.uploadPolicy;this.uploadAction=this.editor.imgUploadAction||this.editor.uploadAction;this.onUploaded=this.editor.imgOnUploaded||this.editor.onUploaded;this.buildMenuPanel();this.editor.dblclickHandlers.push(function(d){if(d.target&&d.target.tagName.toUpperCase()=="IMG"){c.selectedImg=d.target;c.setImageForm(d.target,true);c.showMenuPanel()}});this.editor.clickHandlers.push(function(d){if(d.target&&d.target.tagName.toUpperCase()=="IMG"){}else{c.selectedImg=null}})},showMenuPanel:function(){this.editor.hideMenus();this.menuPanel.open();this.editor.curMenuPanel=this.menuPanel;this.render()},execute:function(d){var b;var c=this;if(typeof(d)=="string"){d={src:d}}if(this.selectedImg){b=this.selectedImg;this.setImageAtrs(b,d)}else{b=EG.CE({tn:"img",onload:function(){var e=EG.DOM.getOuterHTML(this);c.editor.pasteHTML(e)}});this.setImageAtrs(b,d);b.src=d.src}},render:function(){this.imgForm.render()},getUploadAction:function(b){return EG.MMVC.getPath().upload+"/?uploadPolicy="+this.uploadPolicy+"&type="+b},beforeUpload:function(){return true},buildMenuPanel:function(){var d=this;var f=this.editor.parent||this.editor;if(f.getElement){f=f.getElement()}var h=this.editor.imgPickers;this.menuPanel=new EG.ui.Dialog({closeable:true,lock:true,posFix:true,title:"图片设置",fullable:true,parent:f,width:350,height:"auto",layout:{type:"line",direct:"V"},items:[this.imgForm=new EG.ui.Form({width:350,height:"auto",labelWidth:50,layout:"default",items:[{xtype:"tabPanel",width:"100%",height:120,items:[{tab:{title:"图片",style:"width:60px"},panel:{layout:"table",items:[{xtype:"formItem",pos:[0,0],title:"图片",name:"imgShowArea",type:"label",length:15,notnull:true,height:40},{xtype:"button",pos:[0,1],text:"选择",hidden:h?false:true,click:function(){d.resPicker.open()}},{xtype:"formItem",pos:[1,0],title:"路径",name:"imgSrc",type:"text",style:"overflow:hidden"},{xtype:"formItem",pos:[2,0],title:"宽",name:"imgWidth",type:"text",length:5,style:"width:40px",after:"px"},{xtype:"formItem",pos:[2,1],title:"高",name:"imgHeight",type:"text",length:5,style:"width:40px",after:"px"},{xtype:"formItem",pos:[3,0],title:"隐藏",name:"imgSrcUri",type:"text",hidden:true}]}},{tab:{title:"浮动",style:"width:60px"},tabStyle:"width:100",panel:{layout:"table",items:[{xtype:"formItem",pos:[0,0],title:"环绕",name:"imgFloat",type:"select",textvalues:[["不环绕",""],["向左","left"],["向右","right"]]},{xtype:"formItem",pos:[1,0],title:"左距",name:"imgMarginLeft",type:"text",length:10,after:"px"},{xtype:"formItem",pos:[1,1],title:"右距",name:"imgMarginRight",type:"text",length:10,after:"px"},{xtype:"formItem",pos:[2,0],title:"上距",name:"imgMarginTop",type:"text",length:10,after:"px"},{xtype:"formItem",pos:[2,1],title:"下距",name:"imgMarginBottom",type:"text",length:10,after:"px"}]}}]}]})],btns:[{text:"确定",cls:"eg_button_small",click:function(){d.doInsertImage()}},{text:"取消",cls:"eg_button_small",click:function(){d.menuPanel.close()},style:"margin-left:10px"}]});if(h){this.resPicker_opened=false;var g=h.types;var e=[];this.tpm={};for(var b=0;b<g.length;b++){var c=g[b];e.push([c.title,c.type]);this.tpm[c.type]=c}this.resPicker=new EG.ui.Dialog({renderTo:f,title:"选择图片",width:"100%",height:"auto",style:"margin:10px;z-index:2;",lock:true,posFix:true,layout:{type:"line",direct:"V"},items:[{xtype:"panel",height:EG.ui.FormItem._config.height,layout:"line",items:[this.sltCg=new EG.ui.FormItem({xtype:"formItem",title:"分类",type:"select",textvalues:e,width:200,onchange:function(i){d.loadPickerFiles(i)}}),{xtype:"button",text:"刷新",cls:"eg_button_small",onclick:function(){d.loadPickerFiles(d.sltCg.getValue())}}]},this.rpm=new EG.ui.Panel({xtype:"panel",style:"margin:3px;border:1px solid gray;overflow:auto",height:450}),this.rpf=new EG.ui.Panel({xtype:"panel",style:"margin:3px",height:30})],btns:[{xtype:"button",text:"选择",cls:"eg_button_small",click:function(){d.doPickerSelect()}}],afterOpen:function(){if(!d.resPicker_opened){var i=d.sltCg.getValue();if(i){d.loadPickerFiles(i)}}d.resPicker_opened=true}})}if(this.uploadPolicy||this.uploadAction){this.imgForm.items[0].add({tab:{title:"上传",style:"width:60px"},panel:{layout:"table",items:[{xtype:"formItem",title:"上传",name:"imgUpload",type:"upload",height:50,style:"overflow:hidden",autoupload:true,action:this.uploadAction||this.getUploadAction("image"),callback:function(i){var j=i.file?i.file:i;d.setImageForm({src:j.path});EG.Locker.lock(false);if(d.onUploaded){d.onUploaded.apply(d.editor,[i])}},exts:["JPG","PNG","GIF","BMP"],showWait:true,beforeUpload:function(){return d.beforeUpload("img")}}]}})}},doPickerSelect:function(){var c=this.tpm[this.sltCg.getValue()];var b=c.getSelectedUri();if(b==null){EG.Locker.message("请选择文件");return}this.imgForm.getFormItem("imgSrc").setValue(b.src);this.imgForm.getFormItem("imgShowArea").setValue("<img src='"+b.src+"' height='40' />");this.imgForm.getFormItem("imgSrcUri").setValue(b.uri);this.resPicker.close()},loadPickerFiles:function(b){var c=this.tpm[b];c.load(this.rpm)},setFiles:function(b){this.rpm.clear();this.rpf.getElement().innerHTML=""+b.length+"个文件"},doInsertImage:function(c){var b={};if(arguments.length==0){c=this.imgForm.getData()}b.src=c.imgSrc;if(b.src==""){EG.Locker.message("请选择图片或上传新图片");return}b.width=c.imgWidth;b.height=c.imgHeight;b.style={};if(c.imgFloat!=""){EG.css(b,"float:"+c.imgFloat)}if(c.imgMarginLeft!=""){EG.css(b,"marginLeft:"+c.imgMarginLeft)}if(c.imgMarginRight!=""){EG.css(b,"marginRight:"+c.imgMarginRight)}if(c.imgMarginTop!=""){EG.css(b,"marginTop:"+c.imgMarginTop)}if(c.imgMarginBottom!=""){EG.css(b,"marginBottom:"+c.imgMarginBottom)}b.srcUri=this.imgForm.getFormItem("imgSrcUri").getValue();this.execute(b)},setImageAtrs:function(b,c){if(c.style){EG.css(b,c.style)}if(c.width==null||c.width==""){b.removeAttribute("width")}else{b.width=c.width}if(c.height==null||c.height==""){b.removeAttribute("height")}else{b.height=c.height}if(c.srcUri!=null&&c.srcUri!=""){b.setAttribute("srcUri",c.srcUri)}},setImageFormByImg:function(b){var c={src:b.src,style:b.style};this.setImageForm(c)},setImageForm:function(d){this.imgForm.items[0].getTab(0).select();var f=EG.CE({tn:"img"});var c=this;f.onload=function(){var g=this.width,h=this.height;c.imgForm.getFormItem("imgWidth").setValue(this.width);c.imgForm.getFormItem("imgHeight").setValue(this.height);if(this.width>this.height){this.height=h/(g/100);this.width=100}else{this.width=g/(h/40);this.height=40}};f.style.cursor="pointer";f.ondblclick=function(){window.open(this.src)};f.title="双击查看图片";f.src=d.src;if(d.style){if(d.style["float"]){this.imgForm.getFormItem("imgFloat").setValue(d.style["float"].toLowerCase())}if(d.style.marginLeft){this.imgForm.getFormItem("imgMarginLeft").setValue(d.style.marginLeft.toLowerCase())}if(d.style.marginRight){this.imgForm.getFormItem("imgMarginRight").setValue(d.style.marginRight.toLowerCase())}if(d.style.marginTop){this.imgForm.getFormItem("imgMarginTop").setValue(d.style.marginTop.toLowerCase())}if(d.style.marginBottom){this.imgForm.getFormItem("imgMarginBottom").setValue(d.style.marginBottom.toLowerCase())}}if(d.width!=null){this.imgForm.getFormItem("imgWidth").setValue(d.width)}if(d.height!=null){this.imgForm.getFormItem("imgHeight").setValue(d.height)}this.imgForm.getFormItem("imgShowArea").setValue("");this.imgForm.getFormItem("imgShowArea").prop.getElement().appendChild(f);var e=d.src;var b=EG.Browser.getDomainAddress();if(e.indexOf(b)==0){e=e.substr(b.length)}this.imgForm.getFormItem("imgSrc").setValue(e)}});var a=EG.ui.editor.plugin.Image;EG.ui.Editor.registPlugin("image",a)})();(function(){EG.define("EG.ui.editor.plugin.Indent",{extend:"EG.ui.editor.Plugin",constructor:function(b){this.editor=b;var c=this;this.toolbarButton=new EG.ui.editor.ToolbarButton(b,{type:"indent",click:function(){c.editor.hideMenus();var d=c.toolbarButton.getElement();var e=EG.Tools.getElementPos(d,c.editor.getElement());e.y=d.clientHeight;EG.Style.moveTo(c.menuPanel.dPop,e);c.menuPanel.open()},mouseover:function(){},cls:"indent"});this.buildMenuPanel()},execute:function(b){this.editor.htmlexec(b)},buildMenuPanel:function(){this.menuPanel=new EG.ui.Pop({closeable:true,lock:false,posFix:false,cls:"eg_pop_blank"});var e=this;var f=EG.CE({tn:"div",style:""});for(var c=0,b=a.indents.length;c<b;c++){(function(){var d=a.indents[c];EG.CE({pn:f,tn:"a",cls:e.editor.cls+"-toolbar-indent-box",innerHTML:d[0],onclick:function(){e.execute(d[1]);e.menuPanel.close()}})})()}this.menuPanel.addChildren(f)},statics:{indents:[["增加缩进","Indent"],["减少缩进","Outdent"]]}});var a=EG.ui.editor.plugin.Indent;EG.ui.Editor.registPlugin("indent",a)})();(function(){EG.define("EG.ui.editor.plugin.Italic",{extend:"EG.ui.editor.Plugin",constructor:function(b){this.editor=b;var c=this;this.toolbarButton=new EG.ui.editor.ToolbarButton(b,{type:"italic",click:function(){c.execute()},cls:"italic"})},execute:function(){this.editor.htmlexec("Italic")}});var a=EG.ui.editor.plugin.Italic;EG.ui.Editor.registPlugin("italic",a)})();(function(){EG.define("EG.ui.editor.plugin.List",{extend:"EG.ui.editor.Plugin",constructor:function(b){this.editor=b;var c=this;this.toolbarButton=new EG.ui.editor.ToolbarButton(b,{type:"list",click:function(){c.editor.hideMenus();var d=c.toolbarButton.getElement();var e=EG.Tools.getElementPos(d,c.editor.getElement());e.y=d.clientHeight;EG.Style.moveTo(c.menuPanel.dPop,e);c.menuPanel.open()},mouseover:function(){},cls:"list"});this.buildMenuPanel()},execute:function(b){this.editor.htmlexec("Insert"+b+"List")},buildMenuPanel:function(){this.menuPanel=new EG.ui.Pop({closeable:true,lock:false,posFix:false,cls:"eg_pop_blank"});var e=this;var f=EG.CE({tn:"div",style:""});for(var c=0,b=a.lists.length;c<b;c++){(function(){var d=a.lists[c];EG.CE({pn:f,tn:"a",cls:e.editor.cls+"-toolbar-list-box",innerHTML:d[0],onclick:function(){e.execute(d[1]);e.menuPanel.close()}})})()}this.menuPanel.addChildren(f)},statics:{lists:[["数字列表","Ordered"],["符号列表","Unordered"]]}});var a=EG.ui.editor.plugin.List;EG.ui.Editor.registPlugin("list",a)})();(function(){EG.define("EG.ui.editor.plugin.Textalign",{extend:"EG.ui.editor.Plugin",constructor:function(b){this.editor=b;var c=this;this.toolbarButton=new EG.ui.editor.ToolbarButton(b,{type:"textalign",click:function(){c.editor.hideMenus();var d=c.toolbarButton.getElement();var e=EG.Tools.getElementPos(d,c.editor.getElement());e.y=d.clientHeight;EG.Style.moveTo(c.menuPanel.dPop,e);c.menuPanel.open()},mouseover:function(){},cls:"textalign"});this.buildMenuPanel()},execute:function(b){this.editor.htmlexec("Justify"+b)},buildMenuPanel:function(){this.menuPanel=new EG.ui.Pop({closeable:true,lock:false,posFix:false,cls:"eg_pop_blank"});var e=this;var f=EG.CE({tn:"div",style:""});for(var c=0,b=a.fontaligns.length;c<b;c++){(function(){var d=a.fontaligns[c];EG.CE({pn:f,tn:"a",cls:e.editor.cls+"-toolbar-textalign-box",innerHTML:d[0],onclick:function(){e.execute(d[1]);e.menuPanel.close()}})})()}this.menuPanel.addChildren(f)},statics:{fontaligns:[["左对齐","Left"],["居中对齐","Center"],["右对齐","Right"]]}});var a=EG.ui.editor.plugin.Textalign;EG.ui.Editor.registPlugin("textalign",a)})();(function(){EG.define("EG.ui.editor.plugin.Underline",{extend:"EG.ui.editor.Plugin",constructor:function(b){this.editor=b;var c=this;this.toolbarButton=new EG.ui.editor.ToolbarButton(b,{type:"underline",click:function(){c.execute()},cls:"underline"})},execute:function(){this.editor.htmlexec("Underline")}});var a=EG.ui.editor.plugin.Underline;EG.ui.Editor.registPlugin("underline",a)})();(function(){EG.define("EG.ui.Upload",{extend:"EG.ui.Item",config:{button:null,action:null,callback:null,beforeUpload:null,exts:null,showWait:false,showFilename:true,showPath:true,autoupload:false,onselect:null,filename:null,subSelf:true,cls:"eg_upload",showProcess:false,name:null,paramsConfig:null},constructor:function(a){this.initItem(a);this.idx=EG.UI.GITEMIDX++;EG.UI.GITEMS[this.idx]=this;this.filename=this.name||this.filename||("file"+this.idx);EG.DOM.getActionFrame();if(this.subSelf){this.element=EG.CE({tn:"form",cls:this.cls,method:"post",encoding:"multipart/form-data",target:"actionFrame"})}else{this.element=EG.CE({tn:"div",cls:this.cls})}this.setAction(this.action);EG.CE({ele:this.element,cn:[this.dPath=EG.CE({tn:"div",cls:this.cls+"-dPath",style:"display:none"}),this.dFileName=EG.CE({tn:"div",cls:this.cls+"-dFileName",style:"display:none",cn:[]}),this.dFileinput=EG.CE({tn:"div",cls:this.cls+"-dFileinput",style:"position:relative",cn:[this.dSelectBtn=new EG.ui.Button({text:"选择",click:function(){},style:"margin-left:2px"}),this.fileinput=EG.CE({tn:"input",cls:this.cls+"-fileinput",name:this.filename,type:"file",style:"cursor:pointer;position:absolute;left:0px;top:0px;opacity:0;filter:alpha(opacity=0);"})]}),this.dHiddenParams=EG.CE({tn:"div",style:"display:none"})]});var b=this;EG.bindEvent(this.fileinput,"onchange",function(){var d=EG.getValue(b.fileinput);if(d){var e=d.lastIndexOf("/");if(e==-1){e=d.lastIndexOf("\\")}var c=d.substr(e+1);EG.setValue(b.dFileName,c);if(b.showFilename){EG.show(b.dFileName)}if(b.onselect){b.onselect.apply(b,[d,c])}if(b.autoupload){b.submit()}}else{EG.hide(b.dFileName)}});if(!this.autoupload&&this.showBtn){if(!this.button){this.button=new EG.ui.Button({text:"上传",click:function(){b.submit()},style:"veritical-align:middle;margin-left:10px"}).getElement()}this.element.appendChild(this.button)}EG.css(this.element,this.style);if(this.paramsConfig){this.setParams(this.paramsConfig)}},setAction:function(a){if(this.callback){a+="&callback=parent.EG.UI.GITEMS["+this.idx+"].onUploaded&onerror=parent.EG.UI.GITEMS["+this.idx+"].onError"}if(this.showProcess){a+="&callbackProcess=parent.EG.UI.GITEMS["+this.idx+"].onProcess"}this.action=a;if(this.subSelf){EG.CE({ele:this.element,action:a})}},setValue:function(a){EG.setValue(this.dPath,a)},getValue:function(){return EG.getValue(this.dPath)},getElement:function(){return this.element},setParams:function(b){for(var a in b){this.setParam(a,b[a])}},setParam:function(a,d){var b=this.dHiddenParams.childNodes;var c=null;for(var e in b){if(e.name=="name"){c=e;break}}if(c==null){c=EG.CE({pn:this.dHiddenParams,tn:"input",type:"hidden",name:a,value:d})}c.value=d},removeParam:function(a){var b=this.dHiddenParams.childNodes;var c=null;for(var d in b){if(d.name=="name"){c=d;break}}if(c!=null){EG.DOM.remove(c)}},submit:function(){if(EG.getValue(this.fileinput)==""){EG.Locker.message("请选择文件上传");return}if(!this.checkExt()){EG.Locker.message("上传类型需为"+this.exts+"的一种");return}if(this.beforeUpload&&!this.beforeUpload.apply(this)){return}if(this.showWait){EG.Locker.wait("正在上传文件,请稍后")}this.element.submit()},checkExt:function(){if(!this.exts){return true}var b=this.getExt();for(var a=0;a<this.exts.length;a++){if(this.exts[a].toUpperCase()===b.toUpperCase()){return true}}return false},getExt:function(){var a=EG.getValue(this.fileinput);return(a.substr(a.length-5)).substr((a.substr(a.length-5)).indexOf(".")+1)},onUploaded:function(a){if(this.showPath){EG.show(this.dPath)}EG.setValue(this.dPath,a.path);if(typeof(this.callback)=="string"){if(this.callback=="showImg"){if(a.path==null){throw new Error("上传的返回值中不带path")}EG.setValue(this.dPath,a.path);EG.DOM.removeChilds(this.dPreview);EG.CE({pn:this.dPreview,tn:"img",width:"50",height:"30",src:a.path,style:"cursor:pointer",onclick:function(){window.open(this.src)}})}}else{this.callback.apply(this,arguments)}if(this.showWait){EG.Locker.lock(false)}},onError:function(a){EG.Locker.message(a.exMessage)},onProcess:function(a,b){EG.Locker.message("已上传:"+parseInt(a/1024)+"K"+parseInt((a/b*100))+"%")},render:function(){EG.fit(this)},destroy:function(){EG.UI.GITEMS[this.idx]=null},statics:{Callback:{showImg:"showImg"}}})})();(function(){EG.define("EG.ui.Label",{extend:"EG.ui.Item",config:{title:"",width:null,height:null,style:null},constructor:function(a){this.initItem(a);this.element=EG.CE({tn:"div",innerHTML:this.title});EG.ui.Item.setWidth(this.element,this.width);EG.ui.Item.setHeight(this.element,this.height);EG.css(this.element,this.style)},setValue:function(a){if(typeof(a)=="undefined"){return}EG.setValue(this.element,a)},getValue:function(){return EG.getValue(this.element)},render:function(){EG.fit(this);var a=EG.getSize(this.element);EG.css(this.element,"line-height:"+a.innerHeight+"px")}});EG.ui.Item.regist("label",EG.ui.Label)})();(function(){EG.define("EG.ui.Password",{extend:"EG.ui.Item",config:{length:null,cls:"eg_password"},constructor:function(a){this.initItem(a);this.element=EG.CE({tn:"div",cls:this.cls,cn:[this.input=EG.CE({tn:"input",type:"password",cls:this.cls+"-input"})]});EG.css(this.element,this.style);if(this.length!=null){this.input.maxLength=this.length}},setValue:function(a){EG.setValue(this.input,a)},getValue:function(){return EG.getValue(this.input)},render:function(){EG.fit(this);var a=EG.getSize(this.element);EG.fit({element:this.input,pSize:a});EG.css(this.input,"line-height:"+EG.getSize(this.input).innerHeight+"px")}})})();(function(){EG.define("EG.ui.Text",{extend:"EG.ui.Item",config:{length:null,cls:"eg_text",onkeydown:null,onkeyup:null},constructor:function(a){this.callSuper([a]);if(this.length!=null){this.input.maxLength=this.length}},build:function(){this.element=EG.CE({tn:"div",cls:this.cls,cn:[this.input=EG.CE({tn:"input",type:"text",cls:this.cls+"-input",item:this})]});if(this.onkeydown){EG.Event.bindEvent(this.input,"onkeydown",this.onkeydown)}if(this.onkeyup){EG.Event.bindEvent(this.input,"onkeyup",this.onkeyup)}},setValue:function(a){EG.setValue(this.input,a)},getValue:function(){return EG.getValue(this.input)},render:function(){EG.fit(this);var a=EG.getSize(this.element);EG.fit({element:this.input,pSize:a});EG.css(this.input,"line-height:"+EG.getSize(this.input).innerHeight+"px")}})})();(function(){EG.define("EG.ui.Textarea",{extend:"EG.ui.Item",config:{style:null,cls:"eg_textarea"},constructor:function(a){this.initItem(a);this.element=EG.CE({tn:"div",cls:this.cls,cn:[this.input=EG.CE({tn:"textarea",cls:this.cls+"-input"})]});EG.css(this.element,this.style)},setValue:function(a){EG.setValue(this.input,a)},getValue:function(){return EG.getValue(this.input)},render:function(){EG.fit(this);EG.fit({element:this.input,pSize:EG.getSize(this.element)})}})})();(function(){EG.define("EG.ui.Select",{extend:"EG.ui.Item",config:{onchange:null,textvalues:[],cls:"eg_select",edit:false,onchangeOnbuild:false},constructor:function(b){this.callSuper([b])},build:function(){var b=this;this.builded=false;this.onchangeEvents=[];if(this.onchange!=null){this.bindOnchange(this.onchange)}this.element=EG.CE({tn:"div",cls:this.cls,item:this,onmouseover:a._events.element.onmouseover,onmouseout:a._events.element.onmouseout,cn:[this.input=EG.CE({tn:"div",cls:this.cls+"-input",style:"overflow:hidden",item:this,cn:[this.iptText=EG.CE({tn:"input",cls:this.cls+"-iptText",style:"overflow:hidden"}),this.dArrow=EG.CE({tn:"div",cls:this.cls+"-arrow"})],onclick:a._events.input.onclick}),this.dOpts=EG.CE({tn:"div",cls:this.cls+"-opts"})]});if(!this.edit){this.iptText.readOnly=true}EG.hide(this.dOpts);this.iptText.value="";this.setOptions(this.textvalues);this.builded=true},showOptions:function(){EG.show(this.dOpts);var c=this.getValue();var e=this.dOpts.childNodes;for(var d=0,b=e.length;d<b;d++){if(c==e[d].value){EG.setCls(e[d],["opt","opt-selected"],this.cls)}else{EG.setCls(e[d],"opt",this.cls)}}},setValue:function(g,f){if(f==null){f=true}if(g==null){return}var d,h;for(var e=0,b=this.textvalues.length;e<b;e++){d=this.textvalues[e];if(d[1]==g){h=d[0];break}}if(h==null){this.iptText.value="";return}var c=this.getValue();this.iptText.value=h;this.iptText.v=g;if(c!=g&&f){if(!this.builded&&!this.onchangeOnbuild){return}this.doOnChange(g,c)}},doOnChange:function(d,b){for(var c=0;c<this.onchangeEvents.length;c++){this.onchangeEvents[c].apply(this,[d,b])}},getValue:function(){return this.iptText.v},getSelectedIdx:function(){var b=this.getValue();for(var c=0;c<this.textvalues.length;c++){if(this.textvalues[c][1]==b){return c}}return -1},setOption:function(b,c){this.textvalues[b]=c;EG.CE({ele:this.dOpts.childNodes[b],value:c[1],innerHTML:c[0]});if(this.getSelectedIdx()==b){this.iptText.value=c[0];this.iptText.v=c[1]}},setOptions:function(b,c){this.removeOptions();this.addOptions(b,false);if(this.textvalues&&this.textvalues.length>0){this.setValue(this.textvalues[0][1],c)}this.render()},removeOptions:function(){this.textvalues=[];EG.DOM.removeChilds(this.dOpts);this.setValue("",false)},bindOnchange:function(b){this.onchangeEvents.push(b)},addOptions:function(c,e){if(e==null){e=true}for(var d=0,b=c.length;d<b;d++){this.addOption(c[d],false)}if(e){if(this.textvalues&&this.textvalues.length>0){this.setValue(this.textvalues[0][1],true)}}},addOption:function(b,c){if(c==null){c=true}EG.CE({pn:this.dOpts,tn:"div",cls:this.cls+"-opt",value:b[1],item:this,innerHTML:b[0],onmouseover:a._events.option.onmouseover,onmouseout:a._events.option.onmouseout,onclick:a._events.option.onclick});this.textvalues.push(b);if(c){this.setValue(b[1],true)}},removeOption:function(b,d){if(d==null){d=true}var f=this.getSelectedIdx();EG.Array.del(this.textvalues,b);this.dOpts.removeChild(this.dOpts.childNodes[b]);if(f==b){this.iptText.value="";if(this.textvalues.length==0){return}var e=Math.min(b,this.textvalues.length-1);var c=this.textvalues[e][1];this.setValue(c,d)}},getText:function(b){return EG.getValue(this.iptText,{getText:true,ignoreEmpty:b})},destroy:function(){},render:function(){EG.fit(this);EG.fit({element:this.input,pSize:EG.getSize(this.element)});var c=EG.getSize(this.input);EG.css(this.dOpts,"width:"+c.outerWidth+"px");var b=EG.getSize(this.dArrow);EG.css(this.dArrow,"line-height:"+c.innerHeight+"px;height:"+c.innerHeight+"px");var d=EG.getSize(this.input);EG.fit({element:this.iptText,dSize:{width:c.innerWidth-b.outerWidth,height:"100%"},pSize:EG.getSize(this.input)});EG.css(this.iptText,"line-height:"+EG.getSize(this.iptText).innerHeight+"px;")},statics:{_events:{option:{onmouseover:function(){var b=this.item;EG.setCls(this,["opt","opt-over"],b.cls)},onmouseout:function(){var c=this.item;var b=c.getValue();if(this.value==b){EG.setCls(this,["opt","opt-selected"],c.cls)}else{EG.setCls(this,"opt",c.cls)}},onclick:function(){var b=this.item;b.setValue(this.value);EG.hide(b.dOpts)}},element:{onmouseout:function(c){var b=this.item;if(b.outThread!=null){return}b.outThread=setTimeout(function(){EG.hide(b.dOpts)},10);EG.Event.stopPropagation(c)},onmouseover:function(c){var b=this.item;if(b.outThread!=null){clearTimeout(b.outThread);b.outThread=null}EG.Event.stopPropagation(c)}},input:{onclick:function(){var b=this.item;if(EG.Style.isHide(b.dOpts)){b.showOptions()}else{EG.hide(b.dOpts)}}}}}});var a=EG.ui.Select})();(function(){EG.define("EG.ui.SelectArea",{extend:"EG.ui.Item",config:{onchange:null,textvalues:[],cls:"eg_selectArea",edit:false},constructor:function(a){this.callSuper([a]);if(this.textvalues){this.setTextvalues(this.textvalues)}},build:function(){var a=this;this.element=EG.CE({tn:"div",cls:this.cls,cn:[this.srcSlt=EG.CE({tn:"div",cls:this.cls+"-slts"}),this.dMid=EG.CE({tn:"div",cls:this.cls+"-dMid",cn:[new EG.ui.Button({text:"添加 >>",click:function(){a.move(true)},style:"display:block;margin:10px;"}),new EG.ui.Button({text:"<< 删除",click:function(){a.move()},style:"display:block;margin:10px;"})],style:"width:80px;"}),this.destSlt=EG.CE({tn:"div",cls:this.cls+"-slts"})]});EG.Event.bindUnselect(this.element)},setTextvalues:function(a){EG.DOM.removeChilds(this.srcSlt);EG.DOM.removeChilds(this.destSlt);this.textvalues=a;this.addOptions(this.srcSlt,this.textvalues)},move:function(d){var k=this.destSlt,h=this.srcSlt;if(d){k=this.srcSlt,h=this.destSlt}var g=this._getValues(k).concat(this._getValues(h,true));var a=this._getTextvalues(h);var j=[],e=[];for(var b=0;b<this.textvalues.length;b++){var c=this.textvalues[b];if(EG.Array.has(g,c[1])){j.push(c)}else{e.push(c)}}EG.DOM.removeChilds(k);EG.DOM.removeChilds(h);this.addOptions(h,j);this.addOptions(k,e)},_getValues:function(d,c){var b=d.childNodes;var e=[];for(var a=0;a<b.length;a++){if(c||b[a].selected){e.push(b[a].value)}}return e},_selectOpt:function(b,a){if(a==null){a=true}b.selected=a;b.className=a?this.cls+"-slted":this.cls+"-unslt"},_getIdx:function(c){var b=c.paren.childNodes;for(var a=0;a<b.length;a++){if(b[a]==cn){return a}}throw new Error("未找到索引")},addOptions:function(d,e){var c=this;for(var b=0;b<e.length;b++){var a=e[b];EG.CE({pn:d,tn:"div",innerHTML:a[0],cls:this.cls+"-unslt",value:a[1],onclick:function(k){k=EG.Event.getEvent(k);if(k.shiftKey){if(d.lastIdx!=null){var f=EG.DOM.getIdx(this);var h=Math.min(d.lastIdx,f),l=Math.max(d.lastIdx,f);var i=this.parentNode.childNodes;for(var g=0;g<i.length;g++){c._selectOpt(i[g],false)}for(var g=h;g<=l;g++){c._selectOpt(i[g],true)}}else{d.lastIdx=EG.DOM.getIdx(this);c._selectOpt(this,!this.selected)}}else{if(!k.ctrlKey){var i=this.parentNode.childNodes;for(var g=0;g<i.length;g++){c._selectOpt(i[g],false)}}d.lastIdx=EG.DOM.getIdx(this);c._selectOpt(this,!this.selected)}}})}},clear:function(){EG.DOM.removeChilds(this.destSlt);EG.DOM.removeChilds(this.srcSlt)},clearSourceOptions:function(){EG.DOM.removeChilds(this.srcSlt)},clearSelectedOptions:function(){EG.DOM.removeChilds(this.destSlt)},addSourceOptions:function(a){this.addOptions(this.srcSlt,a)},addSelectedOptions:function(a){this.addOptions(this.destSlt,a)},reset:function(){EG.DOM.removeChilds(this.srcSlt);EG.DOM.removeChilds(this.destSlt);this.addOptions(this.srcSlt,this.textvalues)},setValue:function(c){this.reset();var b=this.srcSlt.childNodes;for(var a=0;a<b.length;a++){if(EG.Array.has(c,b[a].value)){this._selectOpt(b[a],true)}}this.move(true)},getValue:function(){return this._getValues(this.destSlt,true)},getText:function(){var c=[];var b=this.destSlt.childNodes;for(var a=0;a<b.length;a++){c.push(b[a].innerHTML)}return c},_getTextvalues:function(c){var d=[];var b=c.childNodes;for(var a=0;a<b.length;a++){d.push([b[a].innerHTML,b[a].value])}return d},getSelectedTextvalues:function(){return this._getTextvalues(this.destSlt)},render:function(){EG.fit(this);var b=EG.getSize(this.element);var c=EG.getSize(this.dMid).outerWidth;var a=(b.innerWidth-c)/2;EG.fit({element:this.dMid,dSize:{height:"100%"},pSize:b});var d=EG.getSize(this.srcSlt);EG.fit({element:this.srcSlt,dSize:{width:a,height:"100%"},pSize:b});EG.fit({element:this.destSlt,dSize:{width:a,height:"100%"},pSize:b})}})})();(function(){EG.define("EG.ui.Grid",{extend:"EG.ui.Item",config:{cls:"eg_grid",rowClasses:["row-a","row-b"],changeRowClassAble:true,selectRowOnclick:true,selectSingleOnclick:true,boxAble:true,seqAble:true,colSelectAble:false,colOrderAble:false,colAdjAble:false,gridFixed:false,columns:null,rowEvents:{},colEvents:{},remotingCallback:null,showHead:true,showFoot:true,renderTo:null,pageSize:30,toolbar:"first pre stat next last size",cellInnerStyle:null,onOrder:null},constructor:function(cfg){Grid.load();this.callSuper([cfg])},initItem:function(cfg){this.callSuper("initItem",[cfg]);this._currentPage=0;this._dataSize=0;this._pageCount=0;this._segment=-1;this.colOptAble=false},_ef_row:{changeRow_mouseover:function(e){this.grid.overRow(this,true);if(this.grid.fn_row_mouseover){this.grid.fn_row_mouseover.apply(this,[e])}},changeRow_mouseout:function(e){this.grid.overRow(this,false);if(this.grid.fn_row_mouseout){this.grid.fn_row_mouseout.apply(this,[e])}},selectRow_click:function(e){e=EG.Event.getEvent(e);var cns=this.parentNode.childNodes;if(e.shiftKey&&this.grid.lastIdx!=null){var sIdx=Math.min(this.grid.lastIdx,this.index),bIdx=Math.max(this.grid.lastIdx,this.index);var cns=this.parentNode.childNodes;for(var i=0;i<cns.length;i++){this.grid.selectRow(cns[i],false)}for(var i=sIdx;i<=bIdx;i++){this.grid.selectRow(cns[i],true)}}else{this.grid.lastIdx=this.selected?null:this.index;if(!e.ctrlKey){for(var i=0;i<cns.length;i++){if(cns[i]!=this){this.grid.selectRow(cns[i],false)}}}this.grid.selectRow(this,!this.selected)}if(this.grid.clickFn){this.grid.clickFn.apply(this,[e])}}},build:function(){this.element=EG.CE({tn:"div",cn:[this.dTop={tn:"div"},this.dMain=EG.CE({tn:"div",style:"width:100%;overflow:hidden;position:relative;"}),this.dFoot=EG.CE({tn:"div",cls:this.cls+"-foot"})]});EG.Event.bindUnselect(this.element);this.buildHead();this.buildBody();this.buildFixBody();this.buildFixHead();this.initHead();this.buildToolBar();if(!this.showHead){EG.hide(this.dHead,this.dFixHead)}if(!this.showFoot){EG.hide(this.dFoot)}if(this.changeRowClassAble){this.fn_row_mouseover=this.rowEvents.onmouseover;this.fn_row_mouseout=this.rowEvents.onmouseout;this.rowEvents.onmouseover=(this._ef_row.changeRow_mouseover);this.rowEvents.onmouseout=(this._ef_row.changeRow_mouseout)}if(this.selectRowOnclick){this.clickFn=this.rowEvents.onclick;this.rowEvents.onclick=(this._ef_row.selectRow_click)}if(this.colAdjAble){this.colAdjRulerL=EG.CE({pn:this.element,tn:"div",cls:this.cls+"-adjRuler"});this.colAdjRulerR=EG.CE({pn:this.element,tn:"div",cls:this.cls+"-adjRuler"});EG.hide(this.colAdjRulerL,this.colAdjRulerR)}if(this.colOptAble){this.buildColOpt()}},_fn_selectBox:function(){this.grid.selectRow(this.row,!this.selected)},setData:function(data){var me=this;this.data=data;this.boxes=[];EG.DOM.removeChilds(this.tbBody);EG.DOM.removeChilds(this.tbFixBody);var globalRowNumber=0;var i,j,key;for(i=0;i<this.pageSize;i++){var d=this.data[i];if(!d&&!this.gridFixed){break}var row=EG.CE({pn:this.tbBody,tn:"tr",index:i,grid:this,data:d});var rowFix=EG.CE({pn:this.tbFixBody,tn:"tr",index:i});for(key in me.rowEvents){EG.Event.bindEvent(row,key,me.rowEvents[key])}if(this.rowClasses&&this.rowClasses.length){var rowClassName=this.cls+"-"+this.rowClasses[i%this.pageSize%this.rowClasses.length];EG.setCls(row,rowClassName);EG.setCls(rowFix,rowClassName)}globalRowNumber=this._currentPage*this.pageSize+i;if(this.boxAble){var box=new EG.ui.Box({showText:false,row:row,grid:this,onclick:this._fn_selectBox});EG.CE({pn:rowFix,tn:"td",cls:(this.cls+"-fixCol"),style:"width:30px",cn:[{tn:"div",cls:this.cls+"-fixBodyCellInner",cn:[box]}]});row.box=box}if(this.seqAble){EG.CE({pn:rowFix,tn:"td",cls:this.cls+"-fixCol",style:"text-align:center;vertical-align:middle;width:30px",cn:[{tn:"div",cls:this.cls+"-fixBodyCellInner",innerHTML:(globalRowNumber+1)}]})}for(j=0;j<this.columns.length;j++){var column=this.columns[j];var textlength=column.textlength,textlengthEnd=column.textlengthEnd||"",handle=column.handle,field=column.field,fieldClass=column.fieldClass||"txtcenter",width=column.width,fix=column.fix;var col,cellInner;col=EG.CE({tn:"td",cls:this.cls+"-bodyCol",cn:[cellInner=EG.CE({tn:"div",cls:this.cls+"-bodyCellInner"})]});if(this.cellInnerStyle){EG.css(cellInner,this.cellInnerStyle)}if(fieldClass){col.className+=(" "+fieldClass)}for(key in this.colEvents){EG.Event.bindEvent(col,key,this.colEvents[key])}var ihtml;if(d){ihtml=null;if(handle){var hr=handle.apply(this,[this.data[i],i,globalRowNumber]);if(hr!=null){if(hr.nodeType){cellInner.appendChild(hr)}else{if(typeof(hr)=="object"&&hr.length!=null){for(var x=0;x<hr.length;x++){if(EG.ui.Item.isItem(hr[x])){cellInner.appendChild(hr[x].getElement())}else{cellInner.appendChild(hr[x])}}}else{cellInner.innerHTML=hr}}}}else{if(this.data[i][field]||!isNaN(this.data[i][field])){ihtml=this.data[i][field]||"";if(ihtml&&textlength!=null&&ihtml.length>textlength){ihtml=ihtml.substr(0,textlength)+textlengthEnd}cellInner.innerHTML=ihtml}else{cellInner.innerHTML=field}}}else{if(this.gridFixed){cellInner.innerHTML="&nbsp;"}}if(fix){rowFix.appendChild(col);EG.setCls(col,"fixCol",this.cls);EG.setCls(cellInner,"fixBodyCellInner",this.cls)}else{row.appendChild(col)}if(width){EG.css(col,"width:"+(column.outerWidth)+"px");EG.css(cellInner,"width:"+(width)+"px")}}}this.fitFixSize()},buildHead:function(){this.dHead=EG.CE({pn:this.dMain,cls:this.cls+"-head",tn:"div",style:"overflow:hidden;",cn:[this.tHead=EG.CE({tn:"table",border:0,cellPadding:0,cellSpacing:0,style:"table-layout:fixed;",cn:[this.tbHead=EG.CE({tn:"tbody"})]})]})},buildBody:function(){var me=this;this.dBody=EG.CE({pn:this.dMain,cls:this.cls+"-body",tn:"div",style:"overflow:auto;",onscroll:function(){me.dHead.scrollLeft=this.scrollLeft;me.dFixBody.style.top=((-this.scrollTop)+me.dFixHead.clientHeight)+"px"},cn:[this.tBody=EG.CE({tn:"table",border:0,cellPadding:0,cellSpacing:0,style:"table-layout:fixed;",cn:[this.tbBody=EG.CE({tn:"tbody"})]})]})},buildFixHead:function(){this.dFixHead=EG.CE({pn:this.dMain,cls:this.cls+"-fixHead",tn:"div",style:"position:absolute;left:0px;top:0px",cn:[{tn:"table",style:"table-layout:fixed;",border:0,cellPadding:0,cellSpacing:0,cn:[this.tbFixHead=EG.CE({tn:"tbody"})]}]})},buildFixBody:function(){this.dFixBody=EG.CE({pn:this.dMain,cls:this.cls+"-fixBody",tn:"div",style:"position:absolute;overflow:hidden;left:0px;top:0px",cn:[{tn:"table",style:"table-layout:fixed;",border:0,cellPadding:0,cellSpacing:0,cn:[this.tbFixBody=EG.CE({tn:"tbody"})]}]})},render:function(){EG.fit(this);var size=EG.getSize(this.element);var mainHeadsize=EG.getSize(this.dHead);var footSize=EG.getSize(this.dFoot);var mainHeight=size.innerHeight-footSize.outerHeight;var mainBodyHeight=mainHeight-mainHeadsize.outerHeight;EG.css(this.dBody,"height:"+mainBodyHeight+"px");var tableWidth=0;for(var i=0;i<this.columns.length;i++){var column=this.columns[i];var width=column.width;EG.css(column.dHeadInner,"width:"+width+"px");var w=EG.getSize(column.dHeadInner).outerWidth;EG.css(column.tdHead,"width:"+w+"px");column.outerWidth=w;tableWidth+=w}EG.css(this.tHead,"width:"+(tableWidth+Grid.appendHeadWidth)+"px");this.fitFixSize()},fitFixSize:function(){if(this.tbFixBody.childNodes.length>0){var fixBodyTr=this.tbFixBody.childNodes[0];for(var i=0,il=fixBodyTr.childNodes.length;i<il;i++){var cSize=EG.getSize(fixBodyTr.childNodes[i]);EG.css(this.tbFixHead.childNodes[0].childNodes[i],"width:"+cSize.innerWidth+"px")}for(var i=0,il=this.tbBody.childNodes.length;i<il;i++){if(this.tbBody.childNodes[i].childNodes.length==0||this.tbFixBody.childNodes[i].childNodes.length==0){continue}var td=this.tbBody.childNodes[i].childNodes[0];var tdFix=this.tbFixBody.childNodes[i].childNodes[0];var s=EG.getSize(td);var sFix=EG.getSize(tdFix);if(sFix.innerHeight>s.innerHeight){EG.css(td,"height:"+sFix.innerHeight+"px")}else{EG.css(tdFix,"height:"+s.innerHeight+"px")}}}var fixHeadsize=EG.getSize(this.dFixHead);EG.css(this.dBody,"margin-left:"+fixHeadsize.outerWidth+"px");EG.css(this.dHead,"margin-left:"+fixHeadsize.outerWidth+"px");this.dFixBody.style.top=((-this.dBody.scrollTop)+this.dFixHead.clientHeight)+"px"},initHead:function(){var me=this;var hrFix=EG.CE({pn:this.tbFixHead,tn:"tr",cls:me.cls+"-head"});var hr=EG.CE({pn:this.tbHead,tn:"tr",cls:me.cls+"-head"});if(this.boxAble){EG.CE({pn:hrFix,tn:"td",cls:this.cls+"-headCol",style:"text-align:center;",cn:[{tn:"div",cls:this.cls+"-fixHeadCellInner",style:"",cn:[this.boxHead=new EG.ui.Box({showText:false,onselect:function(){me.selectAllBox(!this.selected)}})]}]})}if(this.seqAble){EG.CE({pn:hrFix,tn:"td",cls:this.cls+"-headCol",style:"text-align:center;",cn:[{tn:"div",cls:this.cls+"-fixHeadCellInner",style:"width:12px",innerHTML:"&nbsp;"}]})}for(var i=0;i<this.columns.length;i++){var column=this.columns[i];var header=column.header,headerEvent=column.headerEvent,headerStyle=column.headerStyle,width=column.width,fix=column.fix,order=column.order,field=column.field;var col=EG.CE({pn:fix?hrFix:hr,tn:"td",cls:me.cls+"-headCol",style:"white-space:nowrap",me:this});col.dContent=EG.CE({pn:col,tn:"div",cls:me.cls+"-headCellInner",me:this});if(typeof(header)=="string"){col.dContent.innerHTML=header}else{col.dContent.appendChild(header)}if(me.colOrderAble&&order){col.orderName=typeof(order)=="boolean"?field:order;EG.Event.bindEvent(col,"click",Grid._events.head.onclick)}if(this.colAdjAble){col.dAdj=EG.CE({pn:col,tn:"div",innerHTML:"&nbsp;",className:me.cls+"-head_adj",ondblclick:function(){alert("待实现，双击调整宽度")},onmousedown:function(){me.startAdjColWidth(this.parentNode)}})}column.tdHead=col;column.dHeadInner=col.dContent}EG.CE({pn:hr,tn:"td",cls:this.cls+"-headCol",cn:[{tn:"div",cls:this.cls+"-headCellInner",style:"width:"+Grid.appendHeadWidth+"px"}]})},overRow:function(tr,over){if(typeof(tr)=="number"){tr=this.tbBody.childNodes[tr]}if(tr.selected){return}if(over){if(!tr.oldClass){tr.oldClass=tr.className}EG.setCls(tr,"row-over",this.cls)}else{EG.setCls(tr,tr.oldClass)}},selectRow:function(tr,selected,single){if(typeof(tr)=="number"){tr=this.tbBody.childNodes[tr]}tr.selected=selected;if(tr.selected){if(!tr.oldClass){tr.oldClass=tr.className}EG.setCls(tr,"row-selected",this.cls)}else{EG.setCls(tr,tr.oldClass)}if(this.boxAble){tr.box.select(tr.selected)}if(single){var cns=tr.parentNode.childNodes;for(var i=0;i<cns.length;i++){if(cns[i]!=tr){this.selectRow(cns[i],false)}}}},selectAllBox:function(selected){var trs=this.tbBody.childNodes;for(var i=0,l=trs.length;i<l;i++){this.selectRow(trs[i],selected)}},getSelectIdx:function(){var sd=[];var trs=this.tbBody.childNodes;for(var i=0,l=trs.length;i<l;i++){if(trs[i].selected){sd.push(i)}}return sd},getSelectData:function(key){var sd=[];var trs=this.tbBody.childNodes;for(var i=0,l=trs.length;i<l;i++){if(trs[i].selected){var d=trs[i]["data"];sd.push(key?d[key]:d)}}return sd},setDataSize:function(dataSize){this._dataSize=dataSize;this._pageCount=Math.ceil(this._dataSize/this.pageSize);if(this._currentPage+1>this._pageCount){this._currentPage=this._pageCount-1}if(this._currentPage<0){this._currentPage=0}for(var i=0;i<Grid.handler.gridChangedAction.length;i++){if(this[Grid.handler.gridChangedAction[i]]&&this[Grid.handler.gridChangedAction[i]] instanceof Function){this[Grid.handler.gridChangedAction[i]]()}}},fixColumn:function(colIdx){if(typeof(colIdx)=="string"){colIdx=this.getColumnIdx(colIdx)}var cns=this.tbBody.childNodes;for(var i=cns.length-1;i>=0;i++){EG.CE({pn:this.tbFixBody,tn:"tr",cn:cns[i].childNodes[colIdx]})}EG.CE({pn:this.tbFixHead,tn:"tr",cn:this.tbHead.childNodes[0].childNodes[colIdx]})},getColumnIdx:function(header){var startIdx=0;if(this.boxAble){startIdx++}if(this.seqAble){startIdx++}for(var i=0;i<this.columns.length;i++){if(header==this.columns[i]["header"]){return i+startIdx}}throw new Error("EG.ui.Grid#getColumnIdx:未找到对应列")},getData:function(){return this.data},go:function(pageIdx){if(pageIdx>this._pageCount-1){pageIdx=this._pageCount-1}if(pageIdx<0){pageIdx=0}this._currentPage=pageIdx;if(this.remotingCallback){this.remotingCallback.apply(this["remotingCallbackSrc"]||this,[pageIdx])}if(this.boxAble){this.boxHead.select(false,true)}},prePage:function(){this.go(this._currentPage-1)},nextPage:function(){this.go(this._currentPage+1)},firstPage:function(){this.go(0)},lastPage:function(){this.go(this._pageCount-1)},curPage:function(){this.go(this._currentPage)},buildColOpt:function(){this.dColOtp=EG.CE({pn:EG.getBody(),tn:"div",cls:"pagingGrid_dColOpt",style:"display:none",onmouseleave:function(){EG.hide(this)}});var overFn=function(){this.style.backgroundColor="white"};var outFn=function(){this.style.backgroundColor=""};if(this.colOrderAble){EG.CE({pn:this.dColOtp,tn:"div",innerHTML:"正序",cls:"ele",onclick:function(){},onmouseover:overFn,onmouseout:outFn});EG.CE({pn:this.dColOtp,tn:"div",innerHTML:"倒序",cls:"ele",onclick:function(){},onmouseover:overFn,onmouseout:outFn})}if(this.colSelectAble){EG.CE({pn:this.dColOtp,tn:"div",grid:this,innerHTML:"列",cls:"ele",onmouseenter:function(){var p=EG.Tools.getElementPos(this);EG.css(this.grid.dColSelect,{top:p.y+"px",left:(p.x+this.grid.dColOtp.clientWidth-20)+"px",display:""})},onmouseover:overFn,onmouseout:outFn});this.dColSelect=EG.CE({pn:EG.getBody(),tn:"div",cls:"pagingGrid_dColSelect",style:"display:none",onmouseleave:function(){EG.hide(this)}});for(var i=0,l=this.columns.length;i<l;i++){var column=this.columns[i];var b=new EG.UI.PropBox({title:column.header,onselect:function(){}});this.dColSelect.appendChild(b.getElement())}}},buildToolBar:function(){var tools=this.toolbar.split(/\s+/);for(var i=0;i<tools.length;i++){var method=Grid.handler.toolsMap[tools[i]];var tool;if(!method){continue}tool=eval("this."+method+"()");this.dFoot.appendChild(tool)}},getOptions:function(){return EG.CE({tn:"a",href:"javascript:void(0)",innerHTML:"选择",onclick:function(){alert("1")}})},getFirstPage:function(){var me=this;return EG.CE({tn:"a",href:"javascript:void(0)",cls:this.cls+"-firstPage",onclick:function(){me.firstPage();return false}})},getPrePage:function(){var me=this;return EG.CE({tn:"a",href:"javascript:void(0)",cls:this.cls+"-prePage",onclick:function(){me.prePage();return false}})},getNextPage:function(){var me=this;return EG.CE({tn:"a",href:"javascript:void(0)",cls:this.cls+"-nextPage",onclick:function(){me.nextPage();return false}})},getLastPage:function(){var me=this;return EG.CE({tn:"a",href:"javascript:void(0)",cls:this.cls+"-lastPage",onclick:function(){me.lastPage();return false}})},getState:function(){var me=this;var span=EG.CE({tn:"span",cls:this.cls+"-state",cn:[{tn:"a",cls:this.cls+"-gotoPage",onclick:function(){me.go(parseInt(me.currentPageValue.value)-1)}},{tn:"span",innerHTML:"第"},this.currentPageValue=EG.CE({tn:"input",type:"text",size:2,style:""}),{tn:"span",innerHTML:"/"},this.pageCountValue=EG.CE({tn:"span",innerHTML:this._pageCount}),{tn:"span",innerHTML:"页"}],style:""});return span},getRecordSize:function(){var me=this;return EG.CE({tn:"span",cls:this.cls+"-recordSize",cn:[{tn:"span",innerHTML:"每页"},this.sPageSize=EG.CE({tn:"span",innerHTML:this.pageSize,onclick:function(){if(event.ctrlKey){var ps=prompt("RS");if(ps){me.pageSize=ps;me.go(0)}}}}),{tn:"span",innerHTML:"条",style:"margin-right:5px"},{tn:"span",innerHTML:"共"},this.sizeValue=EG.CE({tn:"span",innerHTML:this._dataSize}),{tn:"span",innerHTML:"条"}]})},_changeState:function(){EG.setValue(this.currentPageValue,this._currentPage+1);this.pageCountValue.innerHTML=this._pageCount;this.sizeValue.innerHTML=this._dataSize;this.sPageSize.innerHTML=this.pageSize},dispose:function(){for(var p in this){if(this[p] instanceof Function){this[p]=function(){alert("The object has been released.")}}else{this[p]=null}}},startAdjColWidth:function(td){Grid.adjAim=td;var me=td.me;var p=EG.Tools.getElementPos(Grid.adjAim,me.getElement(),false);var h=(me.dHead.clientHeight+me.dBody.clientHeight)+"px";EG.css(me.colAdjRulerL,{top:p.y+"px",left:p.x+"px",height:h});EG.css(me.colAdjRulerR,{top:p.y+"px",left:(p.x+td.offsetWidth)+"px",height:h});EG.show(me.colAdjRulerL,me.colAdjRulerR);Grid.adjIng=true},endAdjColWidth:function(){EG.hide(Grid.colAdjRulerL,Grid.colAdjRulerR);Grid.adjAim.style.width=parseInt(EG.String.removeEnd(Grid.colAdjRulerR.style.left,"px"))-parseInt(EG.String.removeEnd(Grid.colAdjRulerL.style.left,"px"))+"px";Grid.adjIng=false},statics:{_events:{head:{onclick:function(){var me=this.me;if(me.curOrderCol&&me.curOrderCol!=this){EG.Style.removeCls(me.curOrderCol.dContent,me.cls+"-head_order_asc");EG.Style.removeCls(me.curOrderCol.dContent,me.cls+"-head_order_desc");me.curOrderDesc="";me.curOrderName="";me.curOrderCol=null}me.curOrderCol=this;me.curOrderName=this.orderName;if(me.curOrderDesc=="desc"){me.curOrderDesc="asc"}else{if(me.curOrderDesc=="asc"){me.curOrderDesc="";me.curOrderName="";me.curOrderCol=null}else{me.curOrderDesc="desc"}}EG.Style.removeCls(this.dContent,me.cls+"-head_order_asc");EG.Style.removeCls(this.dContent,me.cls+"-head_order_desc");if(me.curOrderDesc){EG.Style.addCls(this.dContent,me.cls+"-head_order_"+me.curOrderDesc)}if(me.onOrder){me.onOrder.apply(me.onOrderSrc||me,[this.orderName,me.curOrderDesc])}}}},loaded:false,load:function(){if(Grid.loaded){return}Grid.loaded=true},handler:{grids:[],count:0,toolsMap:{option:"getOptions",pre:"getPrePage",next:"getNextPage",first:"getFirstPage",last:"getLastPage",stat:"getState",size:"getRecordSize",skip:"getSkip"},gridChangedAction:["_changeState"]},adjAim:null,adjIng:false,loaded:false,appendHeadWidth:1000}});var Grid=EG.ui.Grid})();(function(){EG.define("EG.ui.Form",{extend:"EG.ui.Container",config:{editable:true,labelWidth:40,validateAble:true,layout:"table",realForm:false,action:null,isUpload:false,target:null},build:function(){if(this.isUpload){this.realForm=true}this.element=EG.CE({tn:this.realForm?"form":"div"});if(this.isUpload){this.element.encoding="multipart/form-data"}if(this.realForm){this.element.method="POST"}},constructor:function(a){a=EG.ui.Form.filterConfig(a);this.callSuper([a])},getFormItem:function(a){return EG.ui.Form.getFormItem(this,a)},getFormItems:function(){return EG.ui.Form.getFormItems(this)},getData:function(){var e={};var c=this.getFormItems();for(var b=0,a=c.length;b<a;b++){var d=c[b];e[d.name]=d.getValue()}return e},setData:function(d,f){if(d==null){throw new Error("EG.ui.Form.prototype#setData:data不能为null")}var c=this.getFormItems();for(var b=0,a=c.length;b<a;b++){var e=c[b];e.setValue(d[e.name],d);if(f){e.defValue=d[e.name]}}},submit:function(){var b=this.getFormItems();for(var a=0;a<b.length;a++){var c=b[a];c.setSubmitValue(c.getValue())}this.element.action=this.action;if(this.target){this.element.target=this.target}this.element.submit()},reset:function(){var c=this.getFormItems();for(var b=0,a=c.length;b<a;b++){var d=c[b];if(d.defValue!=null){d.setValue(d.defValue)}else{d.setValue(null)}}},clearData:function(){var c=this.getFormItems();for(var b=0,a=c.length;b<a;b++){var d=c[b];d.setValue("")}},validate:function(d){var b=true;var e=this.getFormItems();for(var c=0,a=e.length;c<a;c++){var f=e[c];if(f.editable&&f.prop.cfg&&f.prop.validate){b=(f.prop.validate()&&b);if(!b&&!d){return b}}}return b},setEditable:function(c){var d=this.getFormItems();for(var b=0,a=d.length;b<a;b++){var e=d[b];e.setEditable(c)}},statics:{getFormItem:function(a,c){for(var d=0,b=a.items.length;d<b;d++){var e=a.items[d];if(e instanceof EG.ui.FormItem){if(e.name==c){return e}}else{if(e.isContainer){var f=EG.ui.Form.getFormItem(e,c);if(f){return f}}}}return null},getFormItems:function(b,a){if(!a){a=[]}for(var d=0,c=b.items.length;d<c;d++){var e=b.items[d];if(e instanceof EG.ui.FormItem){a.push(e)}else{if(e.isContainer){EG.ui.Form.getFormItems(e,a)}}}return a},filterConfig:function(b,a){var f=b.xtype=="tabPanel";var c=b.items;if(!c){return b}if(a==null){a=b.labelWidth}for(var d=0;d<c.length;d++){var e=c[d];if(!EG.isLit(e)){continue}if(f){e.panel["xType"]="panel";EG.ui.Form.filterConfig(e.panel,a)}else{if(!e.xtype){e.xtype="formItem"}if(a!=null&&e.labelWidth==null){e.labelWidth=a}if(e.xtype=="formItem"){}else{EG.ui.Form.filterConfig(e,a)}}}return b}}})})();(function(){EG.define("EG.ui.FormItem",{extend:"EG.ui.Item",config:{pos:null,editable:true,name:null,title:null,type:null,typeClass:null,pre:null,after:null,cls:"eg_form-item",labelWidth:40,width:"100%",height:28,validate:null,unnull:false,defValue:null,typeCfg:null,showLeft:true,readLineHeight:22},constructor:function(cfg){this.initItem(cfg);this.cfg=cfg;this.cacheValue=null;this.prop=null;this.element=EG.CE({tn:"div",cls:this.cls,cn:[this.lDiv=EG.CE({tn:"div",cls:this.cls+"-dL",cn:[this.dStar=EG.CE({tn:"div",cls:this.cls+"-star",innerHTML:" * "}),this.dTitle=EG.CE({tn:"div",cls:this.cls+"-title",innerHTML:this.title})]}),this.rDiv=EG.CE({tn:"div",cls:this.cls+"-dR",cn:[this.dPre=EG.CE({tn:"div",cls:this.cls+"-pre",style:"display:none"}),this.dProp=EG.CE({tn:"div",cls:this.cls+"-prop",cn:[this.elementRead=EG.CE({tn:"div",cls:this.cls+"-read"})]}),this.dAfter=EG.CE({tn:"div",cls:this.cls+"-after",style:"display:none"}),this.dError=EG.CE({tn:"div",cls:this.cls+"-error",style:"display:none"})]})]});if(this.type!="upload"){this.iptSub=EG.CE({pn:this.rDiv,tn:"input",type:"hidden",name:this.name,style:"display:none"})}if(this.after){this.dAfter.innerHTML=this.after;EG.show(this.dAfter)}if(this.pre){this.dPre.innerHTML=this.pre;EG.show(this.dPre)}if(!this.unnull){EG.hide(this.dStar)}this.readPropClass();this.setEditable(this.editable,true);if(this.defValue!=null){this.setValue(this.defValue)}EG.ui.Item.doRenderTo(this)},setSubmitValue:function(value){if(this.iptSub){this.iptSub.value=value}},render:function(){EG.fit(this);var pSize=EG.getSize(this.element);var lWidth;if(this.showLeft){EG.fit({element:this.lDiv,dSize:{width:this.labelWidth,height:"100%"},pSize:pSize});var lLineHeight=EG.getSize(this.lDiv).innerHeight;EG.css(this.lDiv,"line-height:"+lLineHeight+"px");EG.show(this.lDiv);lWidth=EG.getSize(this.lDiv).outerWidth}else{EG.hide(this.lDiv);lWidth=0}EG.fit({element:this.rDiv,dSize:{width:pSize.innerWidth-lWidth,height:"100%"},pSize:pSize});var rSize=EG.getSize(this.rDiv);var w=rSize.innerWidth;if(this.after){w=w-EG.getSize(this.dAfter).outerWidth}if(this.pre){w=w-EG.getSize(this.dPre).outerWidth}EG.fit({element:this.dProp,dSize:{width:w,height:"100%"},pSize:rSize});if(this.editable){if(this.prop&&this.prop.render){this.prop.width=w;this.prop.height=rSize.innerHeight;this.prop.render()}}else{EG.fit({element:this.elementRead,pSize:rSize})}},setEditable:function(editable,force){if(this.editable==editable&&force!=true){return}this.editable=editable;if(this.editable){if(!this.prop){this.buildProp();this.propElement=this.prop.getElement();this.dProp.appendChild(this.propElement)}EG.hide(this.elementRead);EG.show(this.propElement)}else{EG.hide(this.dStar);EG.show(this.elementRead);if(this.propElement){EG.hide(this.propElement)}}if(!force){this.setValue(this.cacheValue,this.cacheData)}this.render()},readPropClass:function(){if(!this.typeClass){if(typeof(this.type)=="string"){eval("this.typeClass=EG.ui.form.prop."+EG.Word.first2Uppercase(this.type)+";")}else{if(typeof(this.type)=="function"){this.typeClass=this.type}}}if(!this.typeClass){throw new Error("EG.ui.form.FormItem.prototype#buildProp:无法识别类型"+this.type)}},buildProp:function(){var cfg=this.typeCfg?this.typeCfg:this.cfg;cfg.formItem=this;this.prop=new this.typeClass(cfg)},getForm:function(){var pi=this.pItem;while(pi&&!(pi instanceof EG.ui.Form)){pi=pi.pItem}return(pi instanceof EG.ui.Form)?pi:null},setValue:function(value,data){this.cacheData=data;this.cacheValue=value;var t;if(this.prop&&this.prop.getTitle){t=this.prop.getTitle(value,data)}else{if(this.typeClass.getTitle){t=this.typeClass.getTitle(value,data,this.typeCfg?this.typeCfg:this.cfg)}else{t=value}}if(this.typeClass.setRead){this.typeClass.setRead(this.elementRead,t)}else{if(EG.DOM.isElement(t)){this.elementRead.appendChild(t)}else{EG.setValue(this.elementRead,t)}}if(this.prop&&this.prop.setValue){this.prop.setValue(this.cacheValue,data)}},getValue:function(){if(this.editable){return this.prop.getValue()}else{return this.cacheValue}},destroy:function(){if(this.prop&&this.prop.destroy){this.prop.destroy()}}})})();(function(){EG.define("EG.ui.form.Prop",{extend:"EG.ui.Item",getElement:function(){return this.prop.getElement()},setValue:function(b,a){this.prop.setValue(b,a)},getValue:function(){return this.prop.getValue()},getTitle:null,render:function(){this.prop.width=this.width;this.prop.height=this.height;this.prop.render()},getForm:function(){return this.formItem.getForm()},statics:{bindValidate:function(){var a=this;this.vError=false;var b=function(){a.validate()};if(EG.$in(this.type,["text","password","textarea"])){EG.bindEvent(this.prop.input,"keyup",b);EG.bindEvent(this.prop.input,"blur",b)}else{if(this.type=="select"){this.prop.bindOnchange(b);EG.bindEvent(this.prop.input,"blur",b)}else{if(this.type=="box"){this.prop.bindOnchange(b)}}}EG.bindEvent(this.prop.getElement(),"mouseover",function(){if(a.vError){EG.Tip.error(a.v_msg,this)}});EG.bindEvent(this.prop.getElement(),"mouseout",function(c){EG.Tip.close();EG.Event.stopPropagation(c)})},validate:function(){var c=this.getForm();if(c&&!c.validateAble){return true}var d=this.prop.getValue();this.vError=false;if(EG.String.isBlank(d)){if(this.unnull==true){this.vError=true;this.v_msg=this.formItem.title+"不能为空"}}else{var a=this.minLength;if(a!=null&&d.length<a){this.vError=true;this.v_msg=this.formItem.title+"最小长度为"+a+"个字符"}if(!this.vError){var b=this.vldType;if(b){if(typeof(b)=="string"){this.vError=!(EG.Validate.$is(b,d));if(this.vError){this.v_msg=this.formItem.title+"格式应为"+EG.Validate.getComment(b)}else{this.v_msg=""}}else{if(typeof(b)=="function"){this.vError=!(b(d))}}}}}if(this.vError&&!this.v_msg){this.v_msg="请输入正确的"+this.formItem.title}if(this.onError){this.onError()}return !this.vError},onError:function(){if(this.vError){EG.setCls(this.prop.input,"error",this.prop.cls)}else{EG.setCls(this.prop.input,"input",this.prop.cls)}}}})})();(function(){EG.define("EG.ui.Fieldset",{extend:"EG.ui.Container",config:{cls:"eg_fieldset",showTitle:true,showExpand:true,showBorder:true,layout:"table",bodyPadding:null,title:null},constructor:function(a){var b=this;this.callSuper([a]);if(!this.showTitle){EG.Style.isHide(this.dTitle)}if(!this.showExpand){EG.Style.isHide(this.dCollapse)}if(!this.showBorder){EG.setCls(this.dBody,"dBody-noborder",b.cls)}if(this.bodyPadding!=null){EG.css(this.dBody,"padding:"+this.bodyPadding+"px")}},build:function(){this.element=EG.CE({tn:"fieldset",cls:this.cls,cn:[this.legend=EG.CE({tn:"legend",cls:this.cls+"-legend",cn:[this.dCollapse=EG.CE({tn:"div",cls:this.cls+"-dCollapse "+this.cls+"-dCollapse-show",onclick:function(){var b=EG.Style.isHide(me.dBody);var a=me.cls+"-dCollapse "+me.cls+"-dCollapse-";if(b){EG.show(me.dBody.getElement());EG.setCls(this,"hide",me.cls)}else{EG.hide(me.dBody.getElement());EG.setCls(this,"show",me.cls)}}}),this.dTitle=EG.CE({tn:"div",cls:this.cls+"-dTitle",innerHTML:this.title})]}),this.dBody=EG.CE({tn:"div",cls:this.cls+"-dBody"})]})},getItemContainer:function(){return this.dBody},setInnerHeight:function(a){EG.Item.pack({pEle:this.dBody,height:a});EG.Item.pack({pEle:this.element,height:EG.getSize(this.dBody).outerHeight+EG.getSize(this.legend).outerHeight})},render:function(){EG.fit(this);var a=EG.getSize(this.element);EG.fit({element:this.dBody,pSize:a,dSize:{width:"100%",height:a.innerHeight-EG.getSize(this.legend).outerHeight}});if(this.items.length>0){this.doLayout()}}})})();(function(){EG.define("EG.ui.form.prop.Box",{extend:"EG.ui.form.Prop",config:{type:"box"},constructor:function(a){try{this.prop=new EG.ui.BoxGroup(a)}catch(b){alert(b.message)}},validate:function(){var a=this.getForm();if(a&&!a.validateAble){return true}var b=this.prop.getValue();this.vError=false;if((this.prop.multiple&&b.length==0)||(!this.prop.multiple&&EG.String.isBlank(b))){if(this.unnull==true){this.vError=true;this.v_msg=this.formItem.title+"不能为空"}}if(this.vError&&!this.v_msg){this.v_msg="请选择正确的"+this.formItem.title}if(this.vError){EG.setCls(this.prop.element,"error",this.prop.cls)}else{EG.setCls(this.prop.element,"input",this.prop.cls)}return !this.vError},statics:{getTitle:function(k,c,f){var g=f.textvalues||[];if(!EG.isArray(k)){k=[k]}var e=[];for(var a=0,d=k.length;a<d;a++){var l=k[a];for(var b=0,h=g.length;b<h;b++){if(g[b][1]==l){e.push(g[b][0]);break}}}return e.join(",")}}})})();(function(){EG.define("EG.ui.form.prop.Date",{extend:"EG.ui.form.Prop",constructor:function(a){this.prop=new EG.ui.Date(a)}})})();(function(){EG.define("EG.ui.form.prop.Editor",{extend:"EG.ui.form.Prop",constructor:function(a){this.prop=new EG.ui.Editor(a)}})})();(function(){EG.define("EG.ui.form.prop.Label",{extend:"EG.ui.form.Prop",constructor:function(a){this.prop=new EG.ui.Label(a)}})})();(function(){EG.define("EG.ui.form.prop.Password",{extend:"EG.ui.form.Prop",config:{type:"password",unnull:false,minLength:null,width:"100%",height:20,vldType:null},constructor:function(a){this.initConfig(a);this.prop=new EG.ui.Password(a);EG.ui.form.Prop.bindValidate.apply(this,[a])},validate:function(){return EG.ui.form.Prop.validate.apply(this)},onError:function(){return EG.ui.form.Prop.onError.apply(this)}})})();(function(){EG.define("EG.ui.form.prop.Select",{extend:"EG.ui.form.Prop",config:{type:"select",unnull:false},constructor:function(a){this.initConfig(a);this.prop=new EG.ui.Select(a);EG.ui.form.Prop.bindValidate.apply(this,[a])},validate:function(){var a=this.getForm();if(a&&!a.validateAble){return true}var b=this.prop.getValue();this.vError=false;if(EG.String.isBlank(b+"")){if(this.unnull==true){this.vError=true;this.v_msg=this.formItem.title+"不能为空"}}if(this.vError&&!this.v_msg){this.v_msg="请选择正确的"+this.cfg.title}if(this.vError){EG.setCls(this.prop.input,"error",this.prop.cls)}else{EG.setCls(this.prop.input,"input",this.prop.cls)}return this.vError},statics:{getTitle:function(f,e,a){var c=a.textvalues||[];for(var d=0,b=c.length;d<b;d++){if(c[d][1]==f){return c[d][0]}}return null}}})})();(function(){EG.define("EG.ui.form.prop.SelectArea",{extend:"EG.ui.form.Prop",config:{type:"SelectArea",unnull:false},constructor:function(a){this.initConfig(a);this.prop=new EG.ui.SelectArea(a);EG.ui.form.Prop.bindValidate.apply(this,[a])},validate:function(){this.vError=false;return this.vError},statics:{getTitle:function(h,g,a){var d=a.textvalues||[];var f="";for(var e=0,b=d.length;e<b;e++){for(var c=0;c<h.length;c++){if(d[e][1]==h[c]){f+=(f!=""?",":"")+d[e][0];break}}}return f}}})})();(function(){EG.define("EG.ui.form.prop.Text",{extend:"EG.ui.form.Prop",config:{type:"text",unnull:false,minLength:null,width:"100%",height:20,vldType:null},constructor:function(a){this.initConfig(a);this.prop=new EG.ui.Text(a);EG.ui.form.Prop.bindValidate.apply(this,[a])},validate:function(){return EG.ui.form.Prop.validate.apply(this)},onError:function(){return EG.ui.form.Prop.onError.apply(this)}})})();(function(){EG.define("EG.ui.form.prop.Textarea",{extend:"EG.ui.form.Prop",config:{type:"textarea",unnull:false,minLength:null,width:"100%",height:40,vldType:null},constructor:function(a){this.initConfig(a);this.prop=new EG.ui.Textarea(a);EG.ui.form.Prop.bindValidate.apply(this,[a])},validate:function(){return EG.ui.form.Prop.validate.apply(this)},onError:function(){return EG.ui.form.Prop.onError.apply(this)},statics:{setRead:function(a,b){EG.setValue(a,b?EG.String.replaceAll(EG.String.replaceAll(b,"\n","<br>")," ","&nbsp;"):"")}}})})();(function(){EG.define("EG.ui.form.prop.Upload",{extend:"EG.ui.form.Prop",constructor:function(a){this.prop=new EG.ui.Upload(a)}})})();(function(){var b=EG.ui.Menu=function(c){this.className=c.className||"eg_menu";this.element=EG.CE({tn:"div",cls:this.className})};b.prototype.add=function(c){};b.prototype.open=function(){};b.prototype.close=function(){};var a=EG.ui.MenuItem=function(c){this.className=c.className||"eg_menuItem";this.element=EG.CE({tn:"div",cls:this.className})}})();