class_pred<-function(x){
cart_pred_class<-predict(cartfit,newdata=x[,-1],type="class")
cart_pred_prob<-predict(cartfit,newdata=x[,-1])
cart_pred_prob<-data.frame(cart_pred_prob)
names(cart_pred_prob)=c("class1_prob","class2_prob","class3_prob")
mypred<-mutate(x,class=cart_pred_class,class1_prob=cart_pred_prob$class1_prob,class2_prob=cart_pred_prob$class2_prob,class3_prob=cart_pred_prob$class3_prob)
c1r1<-filter(mypred,class==1 & WNP<21.5 & WP>=33.5)
r1<-rep("WNP<21.5 & WP>=33.5 ==>’À∫≈“Ï≥£",nrow(c1r1))
class1_r1<-mutate(c1r1,rule=r1)
c1r2<-filter(mypred,class==1 & WNP>=21.5 & WP>=42)
r2<-rep("WNP>=21.5 & WP>=42==>’À∫≈“Ï≥£",nrow(c1r2))
class1_r2<-mutate(c1r2,rule=r2)
c1r3<-filter(mypred,class==1 & WNP< 21.5 & WP< 33.5 & OWP>=17.5)
r3<-rep("WNP< 21.5 & WP< 33.5 & OWP>=17.5==>’À∫≈“Ï≥£",nrow(c1r3))
class1_r3<-mutate(c1r3,rule=r3)
class1_rule<-rbind(class1_r1,class1_r2,class1_r3)
result<-list(class123=mypred,class1=class1_rule)
return(result)
}
